(function(){function e(e,t,n){for(var i=(n||0)-1,r=e?e.length:0;++i<r;)if(e[i]===t)return i;return-1}function t(t,n){var i=typeof n;if(t=t.cache,"boolean"==i||null==n)return t[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:v+n;return t=(t=t[i])&&t[r],"object"==i?t&&e(t,n)>-1?0:-1:t?0:-1}function n(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:v+e,r=t[n]||(t[n]={});"object"==n?(r[i]||(r[i]=[])).push(e):r[i]=!0}}function i(e){return e.charCodeAt(0)}function r(e,t){for(var n=e.criteria,i=t.criteria,r=-1,o=n.length;++r<o;){var a=n[r],s=i[r];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return e.index-t.index}function o(e){var t=-1,i=e.length,r=e[0],o=e[i/2|0],a=e[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=c();s["false"]=s["null"]=s["true"]=s.undefined=!1;var u=c();for(u.array=e,u.cache=s,u.push=n;++t<i;)u.push(e[t]);return u}function a(e){return"\\"+Z[e]}function s(){return d.pop()||[]}function c(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function u(e){e.length=0,d.length<b&&d.push(e)}function l(e){var t=e.cache;t&&l(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,m.length<b&&m.push(e)}function h(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,r=n-t||0,o=Array(0>r?0:r);++i<r;)o[i]=e[t+i];return o}function p(n){function d(e){return e&&"object"==typeof e&&!$i(e)&&Si.call(e,"__wrapped__")?e:new m(e)}function m(e,t){this.__chain__=!!t,this.__wrapped__=e}function b(e){function t(){if(i){var e=h(i);Vi.apply(e,arguments)}if(this instanceof t){var o=K(n.prototype),a=n.apply(o,e||arguments);return Pt(a)?a:o}return n.apply(r,e||arguments)}var n=e[0],i=e[2],r=e[4];return Qi(t,e),t}function Z(e,t,n,i,r){if(n){var o=n(e);if("undefined"!=typeof o)return o}var a=Pt(e);if(!a)return e;var c=xi.call(e);if(!X[c])return e;var l=Ki[c];switch(c){case D:case A:return new l(+e);case N:case Y:return new l(e);case B:return o=l(e.source,H.exec(e)),o.lastIndex=e.lastIndex,o}var p=$i(e);if(t){var f=!i;i||(i=s()),r||(r=s());for(var d=i.length;d--;)if(i[d]==e)return r[d];o=p?l(e.length):{}}else o=p?h(e):or({},e);return p&&(Si.call(e,"index")&&(o.index=e.index),Si.call(e,"input")&&(o.input=e.input)),t?(i.push(e),r.push(o),(p?Gt:cr)(e,function(e,a){o[a]=Z(e,t,n,i,r)}),f&&(u(i),u(r)),o):o}function K(e){return Pt(e)?Fi(e):{}}function G(e,t,n){if("function"!=typeof e)return $n;if("undefined"==typeof t||!("prototype"in e))return e;var i=e.__bindData__;if("undefined"==typeof i&&(Gi.funcNames&&(i=!e.name),i=i||!Gi.funcDecomp,!i)){var r=ji.call(e);Gi.funcNames||(i=!k.test(r)),i||(i=P.test(r),Qi(e,i))}if(i===!1||i!==!0&&1&i[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return Vn(e,t)}function Q(e){function t(){var e=c?a:this;if(r){var d=h(r);Vi.apply(d,arguments)}if((o||l)&&(d||(d=h(arguments)),o&&Vi.apply(d,o),l&&d.length<s))return i|=16,Q([n,p?i:-4&i,d,null,a,s]);if(d||(d=arguments),u&&(n=e[f]),this instanceof t){e=K(n.prototype);var m=n.apply(e,d);return Pt(m)?m:e}return n.apply(e,d)}var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],c=1&i,u=2&i,l=4&i,p=8&i,f=n;return Qi(t,e),t}function $(n,i){var r=-1,a=ct(),s=n?n.length:0,c=s>=E&&a===e,u=[];if(c){var h=o(i);h?(a=t,i=h):c=!1}for(;++r<s;){var p=n[r];a(i,p)<0&&u.push(p)}return c&&l(i),u}function et(e,t,n,i){for(var r=(i||0)-1,o=e?e.length:0,a=[];++r<o;){var s=e[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&($i(s)||pt(s))){t||(s=et(s,t,n));var c=-1,u=s.length,l=a.length;for(a.length+=u;++c<u;)a[l++]=s[c]}else n||a.push(s)}return a}function tt(e,t,n,i,r,o){if(n){var a=n(e,t);if("undefined"!=typeof a)return!!a}if(e===t)return 0!==e||1/e==1/t;var c=typeof e,l=typeof t;if(!(e!==e||e&&I[c]||t&&I[l]))return!1;if(null==e||null==t)return e===t;var h=xi.call(e),p=xi.call(t);if(h==S&&(h=F),p==S&&(p=F),h!=p)return!1;switch(h){case D:case A:return+e==+t;case N:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case B:case Y:return e==Ri(t)}var f=h==V;if(!f){var d=Si.call(e,"__wrapped__"),m=Si.call(t,"__wrapped__");if(d||m)return tt(d?e.__wrapped__:e,m?t.__wrapped__:t,n,i,r,o);if(h!=F)return!1;var g=e.constructor,v=t.constructor;if(g!=v&&!(Ct(g)&&g instanceof g&&Ct(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var E=!r;r||(r=s()),o||(o=s());for(var b=r.length;b--;)if(r[b]==e)return o[b]==t;var y=0;if(a=!0,r.push(e),o.push(t),f){if(b=e.length,y=t.length,a=y==b,a||i)for(;y--;){var w=b,R=t[y];if(i)for(;w--&&!(a=tt(e[w],R,n,i,r,o)););else if(!(a=tt(e[y],R,n,i,r,o)))break}}else sr(t,function(t,s,c){return Si.call(c,s)?(y++,a=Si.call(e,s)&&tt(e[s],t,n,i,r,o)):void 0}),a&&!i&&sr(e,function(e,t,n){return Si.call(n,t)?a=--y>-1:void 0});return r.pop(),o.pop(),E&&(u(r),u(o)),a}function nt(e,t,n,i,r){($i(t)?Gt:cr)(t,function(t,o){var a,s,c=t,u=e[o];if(t&&((s=$i(t))||ur(t))){for(var l=i.length;l--;)if(a=i[l]==t){u=r[l];break}if(!a){var h;n&&(c=n(u,t),(h="undefined"!=typeof c)&&(u=c)),h||(u=s?$i(u)?u:[]:ur(u)?u:{}),i.push(t),r.push(u),h||nt(u,t,n,i,r)}}else n&&(c=n(u,t),"undefined"==typeof c&&(c=t)),"undefined"!=typeof c&&(u=c);e[o]=u})}function it(e,t){return e+Mi(Wi()*(t-e+1))}function rt(n,i,r){var a=-1,c=ct(),h=n?n.length:0,p=[],f=!i&&h>=E&&c===e,d=r||f?s():p;if(f){var m=o(d);c=t,d=m}for(;++a<h;){var g=n[a],v=r?r(g,a,n):g;(i?!a||d[d.length-1]!==v:c(d,v)<0)&&((r||f)&&d.push(v),p.push(g))}return f?(u(d.array),l(d)):r&&u(d),p}function ot(e){return function(t,n,i){var r={};n=d.createCallback(n,i,3);var o=-1,a=t?t.length:0;if("number"==typeof a)for(;++o<a;){var s=t[o];e(r,s,n(s,o,t),t)}else cr(t,function(t,i,o){e(r,t,n(t,i,o),o)});return r}}function at(e,t,n,i,r,o){var a=1&t,s=2&t,c=4&t,u=16&t,l=32&t;if(!s&&!Ct(e))throw new Ti;u&&!n.length&&(t&=-17,u=n=!1),l&&!i.length&&(t&=-33,l=i=!1);var p=e&&e.__bindData__;if(p&&p!==!0)return p=h(p),p[2]&&(p[2]=h(p[2])),p[3]&&(p[3]=h(p[3])),!a||1&p[1]||(p[4]=r),!a&&1&p[1]&&(t|=8),!c||4&p[1]||(p[5]=o),u&&Vi.apply(p[2]||(p[2]=[]),n),l&&zi.apply(p[3]||(p[3]=[]),i),p[1]|=t,at.apply(null,p);var f=1==t||17===t?b:Q;return f([e,t,n,i,r,o])}function st(e){return tr[e]}function ct(){var t=(t=d.indexOf)===En?e:t;return t}function ut(e){return"function"==typeof e&&Oi.test(e)}function lt(e){var t,n;return e&&xi.call(e)==F&&(t=e.constructor,!Ct(t)||t instanceof t)?(sr(e,function(e,t){n=t}),"undefined"==typeof n||Si.call(e,n)):!1}function ht(e){return nr[e]}function pt(e){return e&&"object"==typeof e&&"number"==typeof e.length&&xi.call(e)==S||!1}function ft(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),Z(e,t,"function"==typeof n&&G(n,i,1))}function dt(e,t,n){return Z(e,!0,"function"==typeof t&&G(t,n,1))}function mt(e,t){var n=K(e);return t?or(n,t):n}function gt(e,t,n){var i;return t=d.createCallback(t,n,3),cr(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function vt(e,t,n){var i;return t=d.createCallback(t,n,3),bt(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function Et(e,t,n){var i=[];sr(e,function(e,t){i.push(t,e)});var r=i.length;for(t=G(t,n,3);r--&&t(i[r--],i[r],e)!==!1;);return e}function bt(e,t,n){var i=er(e),r=i.length;for(t=G(t,n,3);r--;){var o=i[r];if(t(e[o],o,e)===!1)break}return e}function yt(e){var t=[];return sr(e,function(e,n){Ct(e)&&t.push(n)}),t.sort()}function wt(e,t){return e?Si.call(e,t):!1}function Rt(e){for(var t=-1,n=er(e),i=n.length,r={};++t<i;){var o=n[t];r[e[o]]=o}return r}function Tt(e){return e===!0||e===!1||e&&"object"==typeof e&&xi.call(e)==D||!1}function _t(e){return e&&"object"==typeof e&&xi.call(e)==A||!1}function Ht(e){return e&&1===e.nodeType||!1}function kt(e){var t=!0;if(!e)return t;var n=xi.call(e),i=e.length;return n==V||n==Y||n==S||n==F&&"number"==typeof i&&Ct(e.splice)?!i:(cr(e,function(){return t=!1}),t)}function xt(e,t,n,i){return tt(e,t,"function"==typeof n&&G(n,i,2))}function Ot(e){return Yi(e)&&!Xi(parseFloat(e))}function Ct(e){return"function"==typeof e}function Pt(e){return!(!e||!I[typeof e])}function Mt(e){return Lt(e)&&e!=+e}function jt(e){return null===e}function Lt(e){return"number"==typeof e||e&&"object"==typeof e&&xi.call(e)==N||!1}function St(e){return e&&"object"==typeof e&&xi.call(e)==B||!1}function Vt(e){return"string"==typeof e||e&&"object"==typeof e&&xi.call(e)==Y||!1}function Dt(e){return"undefined"==typeof e}function At(e,t,n){var i={};return t=d.createCallback(t,n,3),cr(e,function(e,n,r){i[n]=t(e,n,r)}),i}function zt(e){var t=arguments,n=2;if(!Pt(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var i=G(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(i=t[--n]);for(var r=h(arguments,1,n),o=-1,a=s(),c=s();++o<n;)nt(e,r[o],i,a,c);return u(a),u(c),e}function Nt(e,t,n){var i={};if("function"!=typeof t){var r=[];sr(e,function(e,t){r.push(t)}),r=$(r,et(arguments,!0,!1,1));for(var o=-1,a=r.length;++o<a;){var s=r[o];i[s]=e[s]}}else t=d.createCallback(t,n,3),sr(e,function(e,n,r){t(e,n,r)||(i[n]=e)});return i}function Ft(e){for(var t=-1,n=er(e),i=n.length,r=di(i);++t<i;){var o=n[t];r[t]=[o,e[o]]}return r}function Bt(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,o=et(arguments,!0,!1,1),a=Pt(e)?o.length:0;++r<a;){var s=o[r];s in e&&(i[s]=e[s])}else t=d.createCallback(t,n,3),sr(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function Yt(e,t,n,i){var r=$i(e);if(null==n)if(r)n=[];else{var o=e&&e.constructor,a=o&&o.prototype;n=K(a)}return t&&(t=d.createCallback(t,i,4),(r?Gt:cr)(e,function(e,i,r){return t(n,e,i,r)})),n}function Xt(e){for(var t=-1,n=er(e),i=n.length,r=di(i);++t<i;)r[t]=e[n[t]];return r}function Ut(e){for(var t=arguments,n=-1,i=et(t,!0,!1,1),r=t[2]&&t[2][t[1]]===e?1:i.length,o=di(r);++n<r;)o[n]=e[i[n]];return o}function qt(e,t,n){var i=-1,r=ct(),o=e?e.length:0,a=!1;return n=(0>n?qi(0,o+n):n)||0,$i(e)?a=r(e,t,n)>-1:"number"==typeof o?a=(Vt(e)?e.indexOf(t,n):r(e,t,n))>-1:cr(e,function(e){return++i>=n?!(a=e===t):void 0}),a}function It(e,t,n){var i=!0;t=d.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o&&(i=!!t(e[r],r,e)););else cr(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Zt(e,t,n){var i=[];t=d.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o;){var a=e[r];t(a,r,e)&&i.push(a)}else cr(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Wt(e,t,n){t=d.createCallback(t,n,3);var i=-1,r=e?e.length:0;if("number"!=typeof r){var o;return cr(e,function(e,n,i){return t(e,n,i)?(o=e,!1):void 0}),o}for(;++i<r;){var a=e[i];if(t(a,i,e))return a}}function Kt(e,t,n){var i;return t=d.createCallback(t,n,3),Qt(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}function Gt(e,t,n){var i=-1,r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:G(t,n,3),"number"==typeof r)for(;++i<r&&t(e[i],i,e)!==!1;);else cr(e,t);return e}function Qt(e,t,n){var i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:G(t,n,3),"number"==typeof i)for(;i--&&t(e[i],i,e)!==!1;);else{var r=er(e);i=r.length,cr(e,function(e,n,o){return n=r?r[--i]:--i,t(o[n],n,o)})}return e}function $t(e,t){var n=h(arguments,2),i=-1,r="function"==typeof t,o=e?e.length:0,a=di("number"==typeof o?o:0);return Gt(e,function(e){a[++i]=(r?t:e[t]).apply(e,n)}),a}function Jt(e,t,n){var i=-1,r=e?e.length:0;if(t=d.createCallback(t,n,3),"number"==typeof r)for(var o=di(r);++i<r;)o[i]=t(e[i],i,e);else o=[],cr(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function en(e,t,n){var r=-1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&$i(e))for(var a=-1,s=e.length;++a<s;){var c=e[a];c>o&&(o=c)}else t=null==t&&Vt(e)?i:d.createCallback(t,n,3),Gt(e,function(e,n,i){var a=t(e,n,i);a>r&&(r=a,o=e)});return o}function tn(e,t,n){var r=1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&$i(e))for(var a=-1,s=e.length;++a<s;){var c=e[a];o>c&&(o=c)}else t=null==t&&Vt(e)?i:d.createCallback(t,n,3),Gt(e,function(e,n,i){var a=t(e,n,i);r>a&&(r=a,o=e)});return o}function nn(e,t,n,i){if(!e)return n;var r=arguments.length<3;t=d.createCallback(t,i,4);var o=-1,a=e.length;if("number"==typeof a)for(r&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);else cr(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)});return n}function rn(e,t,n,i){var r=arguments.length<3;return t=d.createCallback(t,i,4),Qt(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function on(e,t,n){return t=d.createCallback(t,n,3),Zt(e,function(e,n,i){return!t(e,n,i)})}function an(e,t,n){if(e&&"number"!=typeof e.length&&(e=Xt(e)),null==t||n)return e?e[it(0,e.length-1)]:f;var i=sn(e);return i.length=Ii(qi(0,t),i.length),i}function sn(e){var t=-1,n=e?e.length:0,i=di("number"==typeof n?n:0);return Gt(e,function(e){var n=it(0,++t);i[t]=i[n],i[n]=e}),i}function cn(e){var t=e?e.length:0;return"number"==typeof t?t:er(e).length}function un(e,t,n){var i;t=d.createCallback(t,n,3);var r=-1,o=e?e.length:0;if("number"==typeof o)for(;++r<o&&!(i=t(e[r],r,e)););else cr(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function ln(e,t,n){var i=-1,o=$i(t),a=e?e.length:0,h=di("number"==typeof a?a:0);for(o||(t=d.createCallback(t,n,3)),Gt(e,function(e,n,r){var a=h[++i]=c();o?a.criteria=Jt(t,function(t){return e[t]}):(a.criteria=s())[0]=t(e,n,r),a.index=i,a.value=e}),a=h.length,h.sort(r);a--;){var p=h[a];h[a]=p.value,o||u(p.criteria),l(p)}return h}function hn(e){return e&&"number"==typeof e.length?h(e):Xt(e)}function pn(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i}function fn(e){return $(e,et(arguments,!0,!0,1))}function dn(e,t,n){var i=-1,r=e?e.length:0;for(t=d.createCallback(t,n,3);++i<r;)if(t(e[i],i,e))return i;return-1}function mn(e,t,n){var i=e?e.length:0;for(t=d.createCallback(t,n,3);i--;)if(t(e[i],i,e))return i;return-1}function gn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=d.createCallback(t,n,3);++o<r&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[0]:f;return h(e,0,Ii(qi(0,i),r))}function vn(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(e=Jt(e,n,i)),et(e,t)}function En(t,n,i){if("number"==typeof i){var r=t?t.length:0;i=0>i?qi(0,r+i):i||0}else if(i){var o=xn(t,n);return t[o]===n?o:-1}return e(t,n,i)}function bn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=d.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return h(e,0,Ii(qi(0,r-i),r))}function yn(){for(var n=[],i=-1,r=arguments.length,a=s(),c=ct(),h=c===e,p=s();++i<r;){var f=arguments[i];($i(f)||pt(f))&&(n.push(f),a.push(h&&f.length>=E&&o(i?n[i]:p)))}var d=n[0],m=-1,g=d?d.length:0,v=[];e:for(;++m<g;){var b=a[0];if(f=d[m],(b?t(b,f):c(p,f))<0){for(i=r,(b||p).push(f);--i;)if(b=a[i],(b?t(b,f):c(n[i],f))<0)continue e;v.push(f)}}for(;r--;)b=a[r],b&&l(b);return u(a),u(p),v}function wn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=d.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[r-1]:f;return h(e,qi(0,r-i))}function Rn(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?qi(0,i+n):Ii(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function Tn(e){for(var t=arguments,n=0,i=t.length,r=e?e.length:0;++n<i;)for(var o=-1,a=t[n];++o<r;)e[o]===a&&(Ai.call(e,o--,1),r--);return e}function _n(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);for(var i=-1,r=qi(0,Ci((t-e)/(n||1))),o=di(r);++i<r;)o[i]=e,e+=n;return o}function Hn(e,t,n){var i=-1,r=e?e.length:0,o=[];for(t=d.createCallback(t,n,3);++i<r;){var a=e[i];t(a,i,e)&&(o.push(a),Ai.call(e,i--,1),r--)}return o}function kn(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,o=e?e.length:0;for(t=d.createCallback(t,n,3);++r<o&&t(e[r],r,e);)i++}else i=null==t||n?1:qi(0,t);return h(e,i)}function xn(e,t,n,i){var r=0,o=e?e.length:r;for(n=n?d.createCallback(n,i,1):$n,t=n(t);o>r;){var a=r+o>>>1;n(e[a])<t?r=a+1:o=a}return r}function On(){return rt(et(arguments,!0,!0))}function Cn(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(n=d.createCallback(n,i,3)),rt(e,t,n)}function Pn(e){return $(e,h(arguments,1))}function Mn(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if($i(n)||pt(n))var i=i?rt($(i,n).concat($(n,i))):n}return i||[]}function jn(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,n=e?en(fr(e,"length")):0,i=di(0>n?0:n);++t<n;)i[t]=fr(e,t);return i}function Ln(e,t){var n=-1,i=e?e.length:0,r={};for(t||!i||$i(e[0])||(t=[]);++n<i;){var o=e[n];t?r[o]=t[n]:o&&(r[o[0]]=o[1])}return r}function Sn(e,t){if(!Ct(t))throw new Ti;return function(){return--e<1?t.apply(this,arguments):void 0}}function Vn(e,t){return arguments.length>2?at(e,17,h(arguments,2),null,t):at(e,1,null,null,t)}function Dn(e){for(var t=arguments.length>1?et(arguments,!0,!1,1):yt(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=at(e[r],1,null,null,e)}return e}function An(e,t){return arguments.length>2?at(t,19,h(arguments,2),null,e):at(t,3,null,null,e)}function zn(){for(var e=arguments,t=e.length;t--;)if(!Ct(e[t]))throw new Ti;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function Nn(e,t){return t="number"==typeof t?t:+t||e.length,at(e,4,null,null,null,t)}function Fn(e,t,n){var i,r,o,a,s,c,u,l=0,h=!1,p=!0;if(!Ct(e))throw new Ti;if(t=qi(0,t)||0,n===!0){var d=!0;p=!1}else Pt(n)&&(d=n.leading,h="maxWait"in n&&(qi(t,n.maxWait)||0),p="trailing"in n?n.trailing:p);var m=function(){var n=t-(mr()-a);if(0>=n){r&&Pi(r);var h=u;r=c=u=f,h&&(l=mr(),o=e.apply(s,i),c||r||(i=s=null))}else c=Di(m,n)},g=function(){c&&Pi(c),r=c=u=f,(p||h!==t)&&(l=mr(),o=e.apply(s,i),c||r||(i=s=null))};return function(){if(i=arguments,a=mr(),s=this,u=p&&(c||!d),h===!1)var n=d&&!c;else{r||d||(l=a);var f=h-(a-l),v=0>=f;v?(r&&(r=Pi(r)),l=a,o=e.apply(s,i)):r||(r=Di(g,f))}return v&&c?c=Pi(c):c||t===h||(c=Di(m,t)),n&&(v=!0,o=e.apply(s,i)),!v||c||r||(i=s=null),o}}function Bn(e){if(!Ct(e))throw new Ti;var t=h(arguments,1);return Di(function(){e.apply(f,t)},1)}function Yn(e,t){if(!Ct(e))throw new Ti;var n=h(arguments,2);return Di(function(){e.apply(f,n)},t)}function Xn(e,t){if(!Ct(e))throw new Ti;var n=function(){var i=n.cache,r=t?t.apply(this,arguments):v+arguments[0];return Si.call(i,r)?i[r]:i[r]=e.apply(this,arguments)};return n.cache={},n}function Un(e){var t,n;if(!Ct(e))throw new Ti;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function qn(e){return at(e,16,h(arguments,1))}function In(e){return at(e,32,null,h(arguments,1))}function Zn(e,t,n){var i=!0,r=!0;if(!Ct(e))throw new Ti;return n===!1?i=!1:Pt(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),U.leading=i,U.maxWait=t,U.trailing=r,Fn(e,t,U)}function Wn(e,t){return at(t,16,[e])}function Kn(e){return function(){return e}}function Gn(e,t,n){var i=typeof e;if(null==e||"function"==i)return G(e,t,n);if("object"!=i)return ni(e);var r=er(e),o=r[0],a=e[o];return 1!=r.length||a!==a||Pt(a)?function(t){for(var n=r.length,i=!1;n--&&(i=tt(t[r[n]],e[r[n]],null,!0)););return i}:function(e){var t=e[o];return a===t&&(0!==a||1/a==1/t)}}function Qn(e){return null==e?"":Ri(e).replace(rr,st)}function $n(e){return e}function Jn(e,t,n){var i=!0,r=t&&yt(t);t&&(n||r.length)||(null==n&&(n=t),o=m,t=e,e=d,r=yt(t)),n===!1?i=!1:Pt(n)&&"chain"in n&&(i=n.chain);var o=e,a=Ct(o);Gt(r,function(n){var r=e[n]=t[n];a&&(o.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,a=[n];Vi.apply(a,arguments);var s=r.apply(e,a);if(i||t){if(n===s&&Pt(s))return this;s=new o(s),s.__chain__=t}return s})})}function ei(){return n._=ki,this}function ti(){}function ni(e){return function(t){return t[e]}}function ii(e,t,n){var i=null==e,r=null==t;if(null==n&&("boolean"==typeof e&&r?(n=e,e=1):r||"boolean"!=typeof t||(n=t,r=!0)),i&&r&&(t=1),e=+e||0,r?(t=e,e=0):t=+t||0,n||e%1||t%1){var o=Wi();return Ii(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return it(e,t)}function ri(e,t){if(e){var n=e[t];return Ct(n)?e[t]():n}}function oi(e,t,n){var i=d.templateSettings;e=Ri(e||""),n=ar({},n,i);var r,o=ar({},n.imports,i.imports),s=er(o),c=Xt(o),u=0,l=n.interpolate||C,h="__p += '",p=wi((n.escape||C).source+"|"+l.source+"|"+(l===x?_:C).source+"|"+(n.evaluate||C).source+"|$","g");e.replace(p,function(t,n,i,o,s,c){return i||(i=o),h+=e.slice(u,c).replace(M,a),n&&(h+="' +\n__e("+n+") +\n'"),s&&(r=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=c+t.length,t}),h+="';\n";var m=n.variable,g=m;g||(m="obj",h="with ("+m+") {\n"+h+"\n}\n"),h=(r?h.replace(w,""):h).replace(R,"$1").replace(T,"$1;"),h="function("+m+") {\n"+(g?"":m+" || ("+m+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+L++ +"]")+"\n*/";try{var E=vi(s,"return "+h+v).apply(f,c)}catch(b){throw b.source=h,b}return t?E(t):(E.source=h,E)}function ai(e,t,n){e=(e=+e)>-1?e:0;var i=-1,r=di(e);for(t=G(t,n,1);++i<e;)r[i]=t(i);return r}function si(e){return null==e?"":Ri(e).replace(ir,ht)}function ci(e){var t=++g;return Ri(null==e?"":e)+t}function ui(e){return e=new m(e),e.__chain__=!0,e}function li(e,t){return t(e),e}function hi(){return this.__chain__=!0,this}function pi(){return Ri(this.__wrapped__)}function fi(){return this.__wrapped__}n=n?J.defaults(W.Object(),n,J.pick(W,j)):W;var di=n.Array,mi=n.Boolean,gi=n.Date,vi=n.Function,Ei=n.Math,bi=n.Number,yi=n.Object,wi=n.RegExp,Ri=n.String,Ti=n.TypeError,_i=[],Hi=yi.prototype,ki=n._,xi=Hi.toString,Oi=wi("^"+Ri(xi).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ci=Ei.ceil,Pi=n.clearTimeout,Mi=Ei.floor,ji=vi.prototype.toString,Li=ut(Li=yi.getPrototypeOf)&&Li,Si=Hi.hasOwnProperty,Vi=_i.push,Di=n.setTimeout,Ai=_i.splice,zi=_i.unshift,Ni=function(){try{var e={},t=ut(t=yi.defineProperty)&&t,n=t(e,e,e)&&t}catch(i){}return n}(),Fi=ut(Fi=yi.create)&&Fi,Bi=ut(Bi=di.isArray)&&Bi,Yi=n.isFinite,Xi=n.isNaN,Ui=ut(Ui=yi.keys)&&Ui,qi=Ei.max,Ii=Ei.min,Zi=n.parseInt,Wi=Ei.random,Ki={};Ki[V]=di,Ki[D]=mi,Ki[A]=gi,Ki[z]=vi,Ki[F]=yi,Ki[N]=bi,Ki[B]=wi,Ki[Y]=Ri,m.prototype=d.prototype;var Gi=d.support={};Gi.funcDecomp=!ut(n.WinRTError)&&P.test(p),Gi.funcNames="string"==typeof vi.name,d.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:x,variable:"",imports:{_:d}},Fi||(K=function(){function e(){}return function(t){if(Pt(t)){e.prototype=t;var i=new e;e.prototype=null}return i||n.Object()}}());var Qi=Ni?function(e,t){q.value=t,Ni(e,"__bindData__",q)}:ti,$i=Bi||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&xi.call(e)==V||!1},Ji=function(e){var t,n=e,i=[];if(!n)return i;if(!I[typeof e])return i;for(t in n)Si.call(n,t)&&i.push(t);return i},er=Ui?function(e){return Pt(e)?Ui(e):[]}:Ji,tr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},nr=Rt(tr),ir=wi("("+er(nr).join("|")+")","g"),rr=wi("["+er(tr).join("")+"]","g"),or=function(e,t,n){var i,r=e,o=r;if(!r)return o;var a=arguments,s=0,c="number"==typeof n?2:a.length;if(c>3&&"function"==typeof a[c-2])var u=G(a[--c-1],a[c--],2);else c>2&&"function"==typeof a[c-1]&&(u=a[--c]);for(;++s<c;)if(r=a[s],r&&I[typeof r])for(var l=-1,h=I[typeof r]&&er(r),p=h?h.length:0;++l<p;)i=h[l],o[i]=u?u(o[i],r[i]):r[i];return o},ar=function(e,t,n){var i,r=e,o=r;if(!r)return o;for(var a=arguments,s=0,c="number"==typeof n?2:a.length;++s<c;)if(r=a[s],r&&I[typeof r])for(var u=-1,l=I[typeof r]&&er(r),h=l?l.length:0;++u<h;)i=l[u],"undefined"==typeof o[i]&&(o[i]=r[i]);return o},sr=function(e,t,n){var i,r=e,o=r;if(!r)return o;if(!I[typeof r])return o;t=t&&"undefined"==typeof n?t:G(t,n,3);for(i in r)if(t(r[i],i,e)===!1)return o;return o},cr=function(e,t,n){var i,r=e,o=r;if(!r)return o;if(!I[typeof r])return o;t=t&&"undefined"==typeof n?t:G(t,n,3);for(var a=-1,s=I[typeof r]&&er(r),c=s?s.length:0;++a<c;)if(i=s[a],t(r[i],i,e)===!1)return o;return o},ur=Li?function(e){if(!e||xi.call(e)!=F)return!1;var t=e.valueOf,n=ut(t)&&(n=Li(t))&&Li(n);return n?e==n||Li(e)==n:lt(e)}:lt,lr=ot(function(e,t,n){Si.call(e,n)?e[n]++:e[n]=1}),hr=ot(function(e,t,n){(Si.call(e,n)?e[n]:e[n]=[]).push(t)}),pr=ot(function(e,t,n){e[n]=t}),fr=Jt,dr=Zt,mr=ut(mr=gi.now)&&mr||function(){return(new gi).getTime()},gr=8==Zi(y+"08")?Zi:function(e,t){return Zi(Vt(e)?e.replace(O,""):e,t||0)};return d.after=Sn,d.assign=or,d.at=Ut,d.bind=Vn,d.bindAll=Dn,d.bindKey=An,d.chain=ui,d.compact=pn,d.compose=zn,d.constant=Kn,d.countBy=lr,d.create=mt,d.createCallback=Gn,d.curry=Nn,d.debounce=Fn,d.defaults=ar,d.defer=Bn,d.delay=Yn,d.difference=fn,d.filter=Zt,d.flatten=vn,d.forEach=Gt,d.forEachRight=Qt,d.forIn=sr,d.forInRight=Et,d.forOwn=cr,d.forOwnRight=bt,d.functions=yt,d.groupBy=hr,d.indexBy=pr,d.initial=bn,d.intersection=yn,d.invert=Rt,d.invoke=$t,d.keys=er,d.map=Jt,d.mapValues=At,d.max=en,d.memoize=Xn,d.merge=zt,d.min=tn,d.omit=Nt,d.once=Un,d.pairs=Ft,d.partial=qn,d.partialRight=In,d.pick=Bt,d.pluck=fr,d.property=ni,d.pull=Tn,d.range=_n,d.reject=on,d.remove=Hn,d.rest=kn,d.shuffle=sn,d.sortBy=ln,d.tap=li,d.throttle=Zn,d.times=ai,d.toArray=hn,d.transform=Yt,d.union=On,d.uniq=Cn,d.values=Xt,d.where=dr,d.without=Pn,d.wrap=Wn,d.xor=Mn,d.zip=jn,d.zipObject=Ln,d.collect=Jt,d.drop=kn,d.each=Gt,d.eachRight=Qt,d.extend=or,d.methods=yt,d.object=Ln,d.select=Zt,d.tail=kn,d.unique=Cn,d.unzip=jn,Jn(d),d.clone=ft,d.cloneDeep=dt,d.contains=qt,d.escape=Qn,d.every=It,d.find=Wt,d.findIndex=dn,d.findKey=gt,d.findLast=Kt,d.findLastIndex=mn,d.findLastKey=vt,d.has=wt,d.identity=$n,d.indexOf=En,d.isArguments=pt,d.isArray=$i,d.isBoolean=Tt,d.isDate=_t,d.isElement=Ht,d.isEmpty=kt,d.isEqual=xt,d.isFinite=Ot,d.isFunction=Ct,d.isNaN=Mt,d.isNull=jt,d.isNumber=Lt,d.isObject=Pt,d.isPlainObject=ur,d.isRegExp=St,d.isString=Vt,d.isUndefined=Dt,d.lastIndexOf=Rn,d.mixin=Jn,d.noConflict=ei,d.noop=ti,d.now=mr,d.parseInt=gr,d.random=ii,d.reduce=nn,d.reduceRight=rn,d.result=ri,d.runInContext=p,d.size=cn,d.some=un,d.sortedIndex=xn,d.template=oi,d.unescape=si,d.uniqueId=ci,d.all=It,d.any=un,d.detect=Wt,d.findWhere=Wt,d.foldl=nn,d.foldr=rn,d.include=qt,d.inject=nn,Jn(function(){var e={};return cr(d,function(t,n){d.prototype[n]||(e[n]=t)}),e}(),!1),d.first=gn,d.last=wn,d.sample=an,d.take=gn,d.head=gn,cr(d,function(e,t){var n="sample"!==t;d.prototype[t]||(d.prototype[t]=function(t,i){var r=this.__chain__,o=e(this.__wrapped__,t,i);return r||null!=t&&(!i||n&&"function"==typeof t)?new m(o,r):o})}),d.VERSION="2.4.1",d.prototype.chain=hi,d.prototype.toString=pi,d.prototype.value=fi,d.prototype.valueOf=fi,Gt(["join","pop","shift"],function(e){var t=_i[e];d.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new m(n,e):n}}),Gt(["push","reverse","sort","unshift"],function(e){var t=_i[e];d.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Gt(["concat","slice","splice"],function(e){var t=_i[e];d.prototype[e]=function(){return new m(t.apply(this.__wrapped__,arguments),this.__chain__)}}),d}var f,d=[],m=[],g=0,v=+new Date+"",E=75,b=40,y=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",w=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,H=/\w*$/,k=/^\s*function[ \n\r\t]+\w/,x=/<%=([\s\S]+?)%>/g,O=RegExp("^["+y+"]*0+(?=.$)"),C=/($^)/,P=/\bthis\b/,M=/['\n\r\t\u2028\u2029\\]/g,j=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],L=0,S="[object Arguments]",V="[object Array]",D="[object Boolean]",A="[object Date]",z="[object Function]",N="[object Number]",F="[object Object]",B="[object RegExp]",Y="[object String]",X={};X[z]=!1,X[S]=X[V]=X[D]=X[A]=X[N]=X[F]=X[B]=X[Y]=!0;var U={leading:!1,maxWait:0,trailing:!1},q={configurable:!1,enumerable:!1,value:null,writable:!1},I={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Z={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},W=I[typeof window]&&window||this,K=I[typeof exports]&&exports&&!exports.nodeType&&exports,G=I[typeof module]&&module&&!module.nodeType&&module,Q=G&&G.exports===K&&K,$=I[typeof global]&&global;!$||$.global!==$&&$.window!==$||(W=$);var J=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(W._=J,define(function(){return J})):K&&G?Q?(G.exports=J)._=J:K._=J:W._=J}).call(this),THREE.Binder={bind:function(e,t){return function(n,i){i.__binds||(i.__binds=[]);var r=e;_.isArray(n)&&(r=n[0],n=n[1]);for(var o=/^([^.:]*(?:\.[^.:]+)*)?(?:\:(.*))?$/.exec(n),a=o[1].split(/\./g),s=a.pop(),c=o[2]||s,u=a.shift(),l={"this":i}[u]||t[u]||e[u]||r;l&&(n=a.shift());)l=l[n];if(l&&(l.on||l.addEventListener)){var h=function(t){i[c]&&i[c](t,e)};THREE.Binder._polyfill(l,["addEventListener","on"],function(e){l[e](s,h)});var p={target:l,name:s,callback:h};return i.__binds.push(p),h}throw"Cannot bind '"+n+"' in "+this.__name}},unbind:function(){return function(e){e.__binds&&(e.__binds.forEach(function(e){THREE.Binder._polyfill(e.target,["removeEventListener","off"],function(t){e.target[t](e.name,e.callback)})}.bind(this)),e.__binds=[])}},apply:function(e){THREE.EventDispatcher.prototype.apply(e),e.trigger=THREE.Binder._trigger,e.triggerOnce=THREE.Binder._triggerOnce,e.on=e.addEventListener,e.off=e.removeEventListener,e.dispatchEvent=e.trigger},_triggerOnce:function(e){this.trigger(e),this._listeners&&delete this._listeners[e.type]},_trigger:function(e){if(void 0!==this._listeners){var t=e.type,n=this._listeners[t];if(void 0!==n){n=n.slice();var i=n.length;e.target=this;for(var r=0;i>r;r++)n[r].call(this,e,this)}}},_polyfill:function(e,t,n){t.map(function(){return e.method}),t.length&&n(t[0])}},THREE.Api={apply:function(e){e.set=function(e){var t=this.options||{},n=_.reduce(e,function(e,n,i){return t[i]!==n&&(e[i]=n),e},{});this.options=_.extend(t,n),this.trigger({type:"change",options:e,changes:n})},e.get=function(){return this.options},e.api=function(e,t){return e=e||{},t&&_.each(e,function(e,n,i){_.isFunction(e)&&(i[n]=_.partialRight(e,t))}),e.set=this.set.bind(this),e.get=this.get.bind(this),e}}},THREE.Bootstrap=function(e){if(e){var t=[].slice.apply(arguments);e={},t[0]instanceof Node&&(node=t[0],t=t.slice(1),e.element=node),_.isString(t[0])&&(e.plugins=t),_.isArray(t[0])&&(e.plugins=t[0]),t[0]&&(e=_.defaults(e,t[0]))}if(!(this instanceof THREE.Bootstrap))return new THREE.Bootstrap(e);var n={init:!0,element:document.body,plugins:["core"],aliases:{},plugindb:THREE.Bootstrap.Plugins||{},aliasdb:THREE.Bootstrap.Aliases||{}};this.__options=_.defaults(e||{},n),this.__inited=!1,this.__destroyed=!1,this.__installed=[];var i=this.__options.element;i===""+i&&(i=document.querySelector(i)),this.plugins={},this.element=i,this.trigger=this.trigger.bind(this),this.frame=this.frame.bind(this),this.events=["pre","update","render","post"].map(function(e){return{type:e}}),this.__options.init&&this.init()},THREE.Bootstrap.prototype={init:function(){return this.__inited?void 0:(this.__inited=!0,this.install(this.__options.plugins),this)},destroy:function(){return this.__inited&&!this.__destroyed?(this.__destroyed=!0,this.trigger({type:"destroy"}),this.uninstall(),this):void 0},frame:function(){this.events.map(this.trigger)},resolve:function(e){function t(e,n,o){if(o>=256)throw"Plug-in alias recursion detected.";return e=_.filter(e,r),_.each(e,function(e){var r=i[e];r?n=n.concat(t(r,[],o+1)):n.push(e)}),n}e=_.isArray(e)?e:[e];var n=this.__options,i=_.extend({},n.aliasdb,n.aliases),r=function(e){var t=e.split(":");return t[1]?(i[t[0]]=[t[1]],!1):!0};return e=_.filter(e,r),_.each(i,function(e,t){i[t]=_.isArray(e)?e:[e]}),t(e,[],0)},install:function(e){e=_.isArray(e)?e:[e],e=this.resolve(e),_.each(e,this.__install,this),this.__ready()},uninstall:function(e){e&&(e=_.isArray(e)?e:[e],e=this.resolve(e)),_.eachRight(e||this.__installed,this.__uninstall,this)
},__install:function(e){var t=this.__options.plugindb[e];if(!t)throw"[three.install] Cannot install. '"+e+"' is not registered.";if(this.plugins[e])return console.warn("[three.install] "+e+" is already installed.");var n=t,i=new n(this.__options[e]||{},e);return this.plugins[e]=i,flag=i.install(this),this.__installed.push(i),this.trigger({type:"install",plugin:i}),flag},__uninstall:function(e){return(plugin=_.isString(e)?this.plugins[e]:e)?(e=plugin.__name,plugin.uninstall(this),this.__installed=_.without(this.__installed,plugin),delete this.plugins[e],void this.trigger({type:"uninstall",plugin:plugin})):console.warn("[three.uninstall] "+e+"' is not installed.")},__ready:function(){this.triggerOnce({type:"ready"})}},THREE.Binder.apply(THREE.Bootstrap.prototype),THREE.Bootstrap.Plugins={},THREE.Bootstrap.Aliases={},THREE.Bootstrap.Plugin=function(e){this.options=_.defaults(e||{},this.defaults)},THREE.Bootstrap.Plugin.prototype={listen:[],defaults:{},install:function(){},uninstall:function(){}},THREE.Binder.apply(THREE.Bootstrap.Plugin.prototype),THREE.Api.apply(THREE.Bootstrap.Plugin.prototype),THREE.Bootstrap.registerPlugin=function(e,t){var n=function(t){THREE.Bootstrap.Plugin.call(this,t),this.__name=e};n.prototype=_.extend(new THREE.Bootstrap.Plugin,t),THREE.Bootstrap.Plugins[e]=n},THREE.Bootstrap.unregisterPlugin=function(e){delete THREE.Bootstrap.Plugins[e]},THREE.Bootstrap.registerAlias=function(e,t){THREE.Bootstrap.Aliases[e]=t},THREE.Bootstrap.unregisterAlias=function(e){delete THREE.Bootstrap.Aliases[e]},THREE.Bootstrap.registerAlias("empty",["fallback","bind","renderer","size","fill","loop","time"]),THREE.Bootstrap.registerAlias("core",["empty","scene","camera","render","warmup"]),THREE.Bootstrap.registerAlias("VR",["core","cursor","fullscreen","render:vr"]),THREE.Bootstrap.registerPlugin("fallback",{defaults:{force:!1,fill:!0,begin:'<div class="threestrap-fallback" style="display: table; width: 100%; height: 100%;box-sizing: border-box; border: 1px dashed rgba(0, 0, 0, .25);"><div style="display: table-cell; padding: 10px; vertical-align: middle; text-align: center;">',end:"</div></div>",message:'<big><strong>This example requires WebGL</strong></big><br>Visit <a target="_blank" href="http://get.webgl.org/">get.webgl.org</a> for more info</a>'},install:function(e){var t;try{if(t=document.createElement("canvas"),gl=t.getContext("webgl")||t.getContext("experimental-webgl"),!gl||this.options.force)throw"WebGL unavailable.";e.fallback=!1}catch(n){var i=this.options.message,r=this.options.begin,o=this.options.end,a=this.options.fill,s=document.createElement("div");for(s.innerHTML=r+i+o,this.children=[];s.childNodes.length>0;)this.children.push(s.firstChild),e.element.appendChild(s.firstChild);return a&&e.install("fill"),this.div=s,e.fallback=!0,!1}},uninstall:function(e){this.children&&(this.children.forEach(function(e){e.parentNode.removeChild(e)}),this.children=null),delete e.fallback}}),THREE.Bootstrap.registerPlugin("renderer",{defaults:{klass:THREE.WebGLRenderer,parameters:{depth:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!0}},listen:["resize"],install:function(e){var t=e.renderer=new this.options.klass(this.options.parameters);e.canvas=t.domElement,e.element.appendChild(t.domElement)},uninstall:function(e){e.element.removeChild(e.renderer.domElement),delete e.renderer,delete e.canvas},resize:function(e,t){var n=t.renderer,i=n.domElement;i&&"CANVAS"==i.tagName?n.setSize(e.renderWidth,e.renderHeight,!1):(n.setRenderSize&&n.setRenderSize(e.renderWidth,e.renderHeight),n.setSize(e.viewWidth,e.viewHeight,!1))}}),THREE.Bootstrap.registerPlugin("bind",{install:function(e){var t={three:e,window:window};e.bind=THREE.Binder.bind(e,t),e.unbind=THREE.Binder.unbind(e),e.bind("install:bind",this),e.bind("uninstall:unbind",this)},uninstall:function(e){e.unbind(this),delete e.bind,delete e.unbind},bind:function(e,t){var n=e.plugin,i=n.listen;i&&i.forEach(function(e){t.bind(e,n)})},unbind:function(e,t){t.unbind(e.plugin)}}),THREE.Bootstrap.registerPlugin("size",{defaults:{width:null,height:null,aspect:null,scale:1,maxRenderWidth:1/0,maxRenderHeight:1/0,devicePixelRatio:!0},listen:["window.resize:queue","element.resize:queue","this.change:queue","ready:resize","pre:pre"],install:function(e){e.Size=this.api({renderWidth:0,renderHeight:0,viewWidth:0,viewHeight:0}),this.resized=!1},uninstall:function(e){delete e.Size},queue:function(){this.resized=!0},pre:function(e,t){this.resized&&(this.resized=!1,this.resize(e,t))},resize:function(e,t){var n,i,r,o,a,s,c,u,l,h=this.options,p=t.element,f=t.renderer,d=0,m=0;n=r=void 0===h.width||null==h.width?p.offsetWidth||p.innerWidth||0:h.width,i=o=void 0===h.height||null==h.height?p.offsetHeight||p.innerHeight||0:h.height,c=n/i,h.aspect&&(h.aspect>c?(i=Math.round(n/h.aspect),m=Math.floor((o-i)/2)):(n=Math.round(i*h.aspect),d=Math.floor((r-n)/2)),c=n/i),l=1,h.devicePixelRatio&&"undefined"!=typeof window&&(l=window.devicePixelRatio||1),a=Math.round(Math.min(n*l*h.scale,h.maxRenderWidth)),s=Math.round(Math.min(i*l*h.scale,h.maxRenderHeight)),raspect=a/s,raspect>c?a=Math.round(s*c):s=Math.round(a/c),l=s/i,u=f.domElement.style,u.width=n+"px",u.height=i+"px",u.marginLeft=d+"px",u.marginTop=m+"px",_.extend(t.Size,{renderWidth:a,renderHeight:s,viewWidth:n,viewHeight:i,aspect:c,pixelRatio:l}),t.trigger({type:"resize",renderWidth:a,renderHeight:s,viewWidth:n,viewHeight:i,aspect:c,pixelRatio:l})}}),THREE.Bootstrap.registerPlugin("fill",{defaults:{block:!0,body:!0,layout:!0},install:function(e){function t(e){var t=e.style.height;return"auto"==t||""==t}function n(e){return e.style.height="100%",e.style.margin=0,e.style.padding=0,e}if(this.options.body&&e.element==document.body&&(this.applied=[e.element,document.documentElement].filter(t).map(n)),this.options.block&&e.canvas&&(e.canvas.style.display="block",this.block=!0),this.options.layout&&e.element){var i=window.getComputedStyle(e.element);"static"==i.position&&(e.element.style.position="relative",this.layout=!0)}},uninstall:function(e){function t(e){return e.style.height="",e.style.margin="",e.style.padding="",e}this.applied&&(this.applied.map(t),delete this.applied),this.block&&e.canvas&&(e.canvas.style.display="",delete this.block),this.layout&&e.element&&(e.element.style.position="",delete this.layout)},change:function(e){this.uninstall(e),this.install(e)}}),THREE.Bootstrap.registerPlugin("loop",{defaults:{start:!0,force:!0,rate:1},listen:["ready","window.resize:reset","dirty","post"],install:function(e){this.running=!1,this.pending=!1,e.Loop=this.api({start:this.start.bind(this),stop:this.stop.bind(this),running:!1},e),this.frame=0},uninstall:function(e){this.stop(e)},ready:function(e,t){this.options.start&&this.start(t)},dirty:function(e,t){this.running||!this.options.force||this.pending||(this.reset(),requestAnimationFrame(t.frame),this.pending=!0)},post:function(){this.pending=!1},reset:function(){this.frame=0},start:function(e){if(!this.running){e.Loop.running=this.running=!0;var t=(e.trigger.bind(e),function(){this.running&&requestAnimationFrame(t);var n=this.options.rate;(1>=n||this.frame%n==0)&&e.frame(),this.frame++}.bind(this));requestAnimationFrame(t),e.trigger({type:"start"})}},stop:function(e){this.running&&(e.Loop.running=this.running=!1,e.trigger({type:"stop"}))}}),THREE.Bootstrap.registerPlugin("time",{defaults:{speed:1,warmup:0,timeout:1},listen:["pre:tick","this.change"],now:function(){return+new Date/1e3},install:function(e){e.Time=this.api({now:this.now(),clock:0,step:1/60,frames:0,time:0,delta:1/60,average:0,fps:0}),this.last=0,this.time=0,this.clock=0,this.wait=this.options.warmup,this.clockStart=0,this.timeStart=0},tick:function(e,t){var n=this.options.speed,i=this.options.timeout,r=t.Time,o=r.now=this.now(),a=this.last,s=this.time,c=this.clock;if(a){var u=r.delta=o-a,l=r.average||u;u>i&&(u=0);var h=u*n;s+=u,c+=h,r.frames>0&&(r.average=l+.1*(u-l),r.fps=1/l),r.step=h,r.clock=c-this.clockStart,r.time=s-this.timeStart,r.frames++,this.wait-->0&&(this.clockStart=c,this.timeStart=s,r.clock=0,r.step=1e-100)}this.last=o,this.clock=c,this.time=s},uninstall:function(e){delete e.Time}}),THREE.Bootstrap.registerPlugin("scene",{install:function(e){e.scene=new THREE.Scene},uninstall:function(e){delete e.scene}}),THREE.Bootstrap.registerPlugin("camera",{defaults:{near:.1,far:1e4,type:"perspective",fov:60,aspect:null,left:-1,right:1,bottom:-1,top:1,klass:null,parameters:null},listen:["resize","this.change"],install:function(e){e.Camera=this.api(),e.camera=null,this.aspect=1,this.change({},e)},uninstall:function(e){delete e.Camera,delete e.camera},change:function(e,t){var n=this.options,i=t.camera;if(!t.camera||e.changes.type||e.changes.klass){var r=n.klass||{perspective:THREE.PerspectiveCamera,orthographic:THREE.OrthographicCamera}[n.type]||THREE.Camera;t.camera=n.parameters?new r(n.parameters):new r}_.each(n,function(e,i){t.camera.hasOwnProperty(i)&&(t.camera[i]=n[i])}.bind(this)),this.update(t),i===t.camera||t.trigger({type:"camera",camera:t.camera})},resize:function(e,t){this.aspect=e.viewWidth/Math.max(1,e.viewHeight),this.update(t)},update:function(e){e.camera.aspect=this.options.aspect||this.aspect,e.camera.updateProjectionMatrix()}}),THREE.Bootstrap.registerPlugin("render",{listen:["render"],render:function(e,t){t.scene&&t.camera&&t.renderer.render(t.scene,t.camera)}}),THREE.Bootstrap.registerPlugin("warmup",{defaults:{delay:2},listen:["ready","post"],ready:function(e,t){t.renderer.domElement.style.visibility="hidden",this.frame=0,this.hidden=!0},post:function(e,t){this.hidden&&this.frame>=this.options.delay&&(t.renderer.domElement.style.visibility="visible",this.hidden=!1),this.frame++}}),THREE.Stats=function(){var e=Date.now(),t=e,n=0,i=1/0,r=0,o=0,a=1/0,s=0,c=0,u=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(e){e.preventDefault(),E(++u%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var h=document.createElement("div");h.id="fps",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(h);var p=document.createElement("div");p.id="fpsText",p.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",p.innerHTML="FPS",h.appendChild(p);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",h.appendChild(f);74>f.children.length;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(d)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(m);var g=document.createElement("div");g.id="msText",g.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",g.innerHTML="MS",m.appendChild(g);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(v);74>v.children.length;)d=document.createElement("span"),d.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(d);var E=function(e){switch(u=e){case 0:h.style.display="block",m.style.display="none";break;case 1:h.style.display="none",m.style.display="block"}};return{REVISION:11,domElement:l,setMode:E,begin:function(){e=Date.now()},end:function(){var u=Date.now();n=u-e,i=Math.min(i,n),r=Math.max(r,n),g.textContent=n+" MS ("+i+"-"+r+")";var l=Math.min(30,30-30*(n/200));return v.appendChild(v.firstChild).style.height=l+"px",c++,u>t+1e3&&(o=Math.round(1e3*c/(u-t)),a=Math.min(a,o),s=Math.max(s,o),p.textContent=o+" FPS ("+a+"-"+s+")",l=Math.min(30,30-30*(o/100)),f.appendChild(f.firstChild).style.height=l+"px",t=u,c=0),u},update:function(){e=this.end()}}},THREE.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var n=function(e){t.deviceOrientation=e},i=function(){t.screenOrientation=window.orientation||0},r=function(){var e=new THREE.Vector3(0,0,1),t=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,o,a,s,c){t.set(a,o,-s,"YXZ"),r.setFromEuler(t),r.multiply(i),r.multiply(n.setFromAxisAngle(e,-c))}}();this.connect=function(){i(),window.addEventListener("orientationchange",i,!1),window.addEventListener("deviceorientation",n,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",i,!1),window.removeEventListener("deviceorientation",n,!1),t.enabled=!1},this.update=function(){if(t.enabled!==!1){var e=t.deviceOrientation.alpha?THREE.Math.degToRad(t.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=t.deviceOrientation.beta?THREE.Math.degToRad(t.deviceOrientation.beta):0,i=t.deviceOrientation.gamma?THREE.Math.degToRad(t.deviceOrientation.gamma):0,o=t.screenOrientation?THREE.Math.degToRad(t.screenOrientation):0;r(t.object.quaternion,e,n,i,o),this.alpha=e}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()},THREE.FirstPersonControls=function(e,t){function n(e){e.preventDefault()}function i(e,t){return function(){t.apply(e,arguments)}}this.object=e,this.target=new THREE.Vector3(0,0,0),this.domElement=void 0!==t?t:document,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(e){this.domElement===document?(this.mouseX=e.pageX-this.viewHalfX,this.mouseY=e.pageY-this.viewHalfY):(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}},this.onKeyUp=function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(e){if(this.enabled!==!1){if(this.heightSpeed){var t=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),n=t-this.heightMin;this.autoSpeedFactor=e*n*this.heightCoef}else this.autoSpeedFactor=0;var i=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(i+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(i),this.moveLeft&&this.object.translateX(-i),this.moveRight&&this.object.translateX(i),this.moveUp&&this.object.translateY(i),this.moveDown&&this.object.translateY(-i);var r=e*this.lookSpeed;this.activeLook||(r=0);var o=1;this.constrainVertical&&(o=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*r,this.lookVertical&&(this.lat-=this.mouseY*r*o),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=THREE.Math.degToRad(90-this.lat),this.theta=THREE.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var a=this.target,s=this.object.position;a.x=s.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=s.y+100*Math.cos(this.phi),a.z=s.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a)}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",n,!1),this.domElement.removeEventListener("mousedown",o,!1),this.domElement.removeEventListener("mousemove",r,!1),this.domElement.removeEventListener("mouseup",a,!1),window.removeEventListener("keydown",s,!1),window.removeEventListener("keyup",c,!1)};var r=i(this,this.onMouseMove),o=i(this,this.onMouseDown),a=i(this,this.onMouseUp),s=i(this,this.onKeyDown),c=i(this,this.onKeyUp);this.domElement.addEventListener("contextmenu",n,!1),this.domElement.addEventListener("mousemove",r,!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mouseup",a,!1),window.addEventListener("keydown",s,!1),window.addEventListener("keyup",c,!1),this.handleResize()},THREE.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*L.autoRotateSpeed}function i(){return Math.pow(.95,L.zoomSpeed)}function r(e){B.theta-=e}function o(e){B.phi-=e}function a(e){L.object instanceof THREE.PerspectiveCamera?Y/=e:L.object instanceof THREE.OrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom*e)),L.object.updateProjectionMatrix(),U=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function s(e){L.object instanceof THREE.PerspectiveCamera?Y*=e:L.object instanceof THREE.OrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom/e)),L.object.updateProjectionMatrix(),U=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function c(e){q.set(e.clientX,e.clientY)}function u(e){Q.set(e.clientX,e.clientY)}function l(e){W.set(e.clientX,e.clientY)}function h(e){I.set(e.clientX,e.clientY),Z.subVectors(I,q);var t=L.domElement===document?L.domElement.body:L.domElement;r(2*Math.PI*Z.x/t.clientWidth*L.rotateSpeed),o(2*Math.PI*Z.y/t.clientHeight*L.rotateSpeed),q.copy(I),L.update()}function p(e){$.set(e.clientX,e.clientY),J.subVectors($,Q),J.y>0?a(i()):J.y<0&&s(i()),Q.copy($),L.update()}function f(e){K.set(e.clientX,e.clientY),G.subVectors(K,W),nt(G.x,G.y),W.copy(K),L.update()}function d(){}function m(e){var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?s(i()):0>t&&a(i()),L.update()}function g(e){switch(e.keyCode){case L.keys.UP:nt(0,L.keyPanSpeed),L.update();break;case L.keys.BOTTOM:nt(0,-L.keyPanSpeed),L.update();break;case L.keys.LEFT:nt(L.keyPanSpeed,0),L.update();break;case L.keys.RIGHT:nt(-L.keyPanSpeed,0),L.update()}}function v(e){q.set(e.touches[0].pageX,e.touches[0].pageY)}function E(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);Q.set(0,i)}function b(e){W.set(e.touches[0].pageX,e.touches[0].pageY)}function y(e){I.set(e.touches[0].pageX,e.touches[0].pageY),Z.subVectors(I,q);var t=L.domElement===document?L.domElement.body:L.domElement;r(2*Math.PI*Z.x/t.clientWidth*L.rotateSpeed),o(2*Math.PI*Z.y/t.clientHeight*L.rotateSpeed),q.copy(I),L.update()}function w(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);$.set(0,r),J.subVectors($,Q),J.y>0?s(i()):J.y<0&&a(i()),Q.copy($),L.update()}function R(e){K.set(e.touches[0].pageX,e.touches[0].pageY),G.subVectors(K,W),nt(G.x,G.y),W.copy(K),L.update()}function T(){}function _(e){if(L.enabled!==!1){if(e.preventDefault(),e.button===L.mouseButtons.ORBIT){if(L.enableRotate===!1)return;c(e),z=A.ROTATE}else if(e.button===L.mouseButtons.ZOOM){if(L.enableZoom===!1)return;u(e),z=A.DOLLY}else if(e.button===L.mouseButtons.PAN){if(L.enablePan===!1)return;l(e),z=A.PAN}z!==A.NONE&&(document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",k,!1),L.dispatchEvent(V))}}function H(e){if(L.enabled!==!1)if(e.preventDefault(),z===A.ROTATE){if(L.enableRotate===!1)return;h(e)}else if(z===A.DOLLY){if(L.enableZoom===!1)return;p(e)}else if(z===A.PAN){if(L.enablePan===!1)return;f(e)}}function k(e){L.enabled!==!1&&(d(e),document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",k,!1),L.dispatchEvent(D),z=A.NONE)}function x(e){L.enabled===!1||L.enableZoom===!1||z!==A.NONE&&z!==A.ROTATE||(e.preventDefault(),e.stopPropagation(),m(e),L.dispatchEvent(V),L.dispatchEvent(D))}function O(e){L.enabled!==!1&&L.enableKeys!==!1&&L.enablePan!==!1&&g(e)}function C(e){if(L.enabled!==!1){switch(e.touches.length){case 1:if(L.enableRotate===!1)return;v(e),z=A.TOUCH_ROTATE;break;case 2:if(L.enableZoom===!1)return;E(e),z=A.TOUCH_DOLLY;break;case 3:if(L.enablePan===!1)return;b(e),z=A.TOUCH_PAN;break;default:z=A.NONE}z!==A.NONE&&L.dispatchEvent(V)}}function P(e){if(L.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(L.enableRotate===!1)return;if(z!==A.TOUCH_ROTATE)return;y(e);break;case 2:if(L.enableZoom===!1)return;if(z!==A.TOUCH_DOLLY)return;w(e);break;case 3:if(L.enablePan===!1)return;if(z!==A.TOUCH_PAN)return;R(e);break;default:z=A.NONE}}function M(e){L.enabled!==!1&&(T(e),L.dispatchEvent(D),z=A.NONE)}function j(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return phi},this.getAzimuthalAngle=function(){return theta},this.reset=function(){L.target.copy(L.target0),L.object.position.copy(L.position0),L.object.zoom=L.zoom0,L.object.updateProjectionMatrix(),L.dispatchEvent(S),L.update(),z=A.NONE},this.update=function(){var t=new THREE.Vector3,i=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),o=i.clone().inverse(),a=new THREE.Vector3,s=new THREE.Quaternion;return function(){var e=L.object.position;return t.copy(e).sub(L.target),t.applyQuaternion(i),F.setFromVector3(t),L.autoRotate&&z===A.NONE&&r(n()),F.theta+=B.theta,F.phi+=B.phi,F.theta=Math.max(L.minAzimuthAngle,Math.min(L.maxAzimuthAngle,F.theta)),F.phi=Math.max(L.minPolarAngle,Math.min(L.maxPolarAngle,F.phi)),F.makeSafe(),F.radius*=Y,F.radius=Math.max(L.minDistance,Math.min(L.maxDistance,F.radius)),L.target.add(X),t.setFromSpherical(F),t.applyQuaternion(o),e.copy(L.target).add(t),L.object.lookAt(L.target),L.enableDamping===!0?(B.theta*=1-L.dampingFactor,B.phi*=1-L.dampingFactor):B.set(0,0,0),Y=1,X.set(0,0,0),U||a.distanceToSquared(L.object.position)>N||8*(1-s.dot(L.object.quaternion))>N?(L.dispatchEvent(S),a.copy(L.object.position),s.copy(L.object.quaternion),U=!1,!0):!1}}(),this.dispose=function(){L.domElement.removeEventListener("contextmenu",j,!1),L.domElement.removeEventListener("mousedown",_,!1),L.domElement.removeEventListener("mousewheel",x,!1),L.domElement.removeEventListener("MozMousePixelScroll",x,!1),L.domElement.removeEventListener("touchstart",C,!1),L.domElement.removeEventListener("touchend",M,!1),L.domElement.removeEventListener("touchmove",P,!1),document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",k,!1),window.removeEventListener("keydown",O,!1)};var L=this,S={type:"change"},V={type:"start"},D={type:"end"},A={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},z=A.NONE,N=1e-6,F=new THREE.Spherical,B=new THREE.Spherical,Y=1,X=new THREE.Vector3,U=!1,q=new THREE.Vector2,I=new THREE.Vector2,Z=new THREE.Vector2,W=new THREE.Vector2,K=new THREE.Vector2,G=new THREE.Vector2,Q=new THREE.Vector2,$=new THREE.Vector2,J=new THREE.Vector2,et=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),X.add(e)}}(),tt=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),X.add(e)}}(),nt=function(){var e=new THREE.Vector3;return function(t,n){var i=L.domElement===document?L.domElement.body:L.domElement;if(L.object instanceof THREE.PerspectiveCamera){var r=L.object.position;e.copy(r).sub(L.target);var o=e.length();o*=Math.tan(L.object.fov/2*Math.PI/180),et(2*t*o/i.clientHeight,L.object.matrix),tt(2*n*o/i.clientHeight,L.object.matrix)}else L.object instanceof THREE.OrthographicCamera?(et(t*(L.object.right-L.object.left)/L.object.zoom/i.clientWidth,L.object.matrix),tt(n*(L.object.top-L.object.bottom)/L.object.zoom/i.clientHeight,L.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),L.enablePan=!1)}}();L.domElement.addEventListener("contextmenu",j,!1),L.domElement.addEventListener("mousedown",_,!1),L.domElement.addEventListener("mousewheel",x,!1),L.domElement.addEventListener("MozMousePixelScroll",x,!1),L.domElement.addEventListener("touchstart",C,!1),L.domElement.addEventListener("touchend",M,!1),L.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",O,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=e}}}),THREE.TrackballControls=function(e,t){function n(e){p.enabled!==!1&&(window.removeEventListener("keydown",n),v=g,g===f.NONE&&(e.keyCode!==p.keys[f.ROTATE]||p.noRotate?e.keyCode!==p.keys[f.ZOOM]||p.noZoom?e.keyCode!==p.keys[f.PAN]||p.noPan||(g=f.PAN):g=f.ZOOM:g=f.ROTATE))}function i(){p.enabled!==!1&&(g=v,window.addEventListener("keydown",n,!1))}function r(e){p.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g===f.NONE&&(g=e.button),g!==f.ROTATE||p.noRotate?g!==f.ZOOM||p.noZoom?g!==f.PAN||p.noPan||(x.copy(j(e.pageX,e.pageY)),O.copy(x)):(T.copy(j(e.pageX,e.pageY)),_.copy(T)):(y.copy(L(e.pageX,e.pageY)),b.copy(y)),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1),p.dispatchEvent(P))}function o(e){p.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g!==f.ROTATE||p.noRotate?g!==f.ZOOM||p.noZoom?g!==f.PAN||p.noPan||O.copy(j(e.pageX,e.pageY)):_.copy(j(e.pageX,e.pageY)):(b.copy(y),y.copy(L(e.pageX,e.pageY))))}function a(e){p.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g=f.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a),p.dispatchEvent(M))}function s(e){if(p.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),T.y+=.01*t,p.dispatchEvent(P),p.dispatchEvent(M)}}function c(e){if(p.enabled!==!1){switch(e.touches.length){case 1:g=f.TOUCH_ROTATE,y.copy(L(e.touches[0].pageX,e.touches[0].pageY)),b.copy(y);break;default:g=f.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;k=H=Math.sqrt(t*t+n*n);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;x.copy(j(i,r)),O.copy(x)}p.dispatchEvent(P)}}function u(e){if(p.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:b.copy(y),y.copy(L(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;k=Math.sqrt(t*t+n*n);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;O.copy(j(i,r))}}function l(e){if(p.enabled!==!1){switch(e.touches.length){case 0:g=f.NONE;break;case 1:g=f.TOUCH_ROTATE,y.copy(L(e.touches[0].pageX,e.touches[0].pageY)),b.copy(y)}p.dispatchEvent(M)}}function h(e){e.preventDefault()}var p=this,f={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var d=1e-6,m=new THREE.Vector3,g=f.NONE,v=f.NONE,E=new THREE.Vector3,b=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector3,R=0,T=new THREE.Vector2,_=new THREE.Vector2,H=0,k=0,x=new THREE.Vector2,O=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var C={type:"change"},P={type:"start"},M={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var j=function(){var e=new THREE.Vector2;return function(t,n){return e.set((t-p.screen.left)/p.screen.width,(n-p.screen.top)/p.screen.height),e}}(),L=function(){var e=new THREE.Vector2;return function(t,n){return e.set((t-.5*p.screen.width-p.screen.left)/(.5*p.screen.width),(p.screen.height+2*(p.screen.top-n))/p.screen.width),e
}}();this.rotateCamera=function(){var e,t=new THREE.Vector3,n=new THREE.Quaternion,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3;return function(){a.set(y.x-b.x,y.y-b.y,0),e=a.length(),e?(E.copy(p.object.position).sub(p.target),i.copy(E).normalize(),r.copy(p.object.up).normalize(),o.crossVectors(r,i).normalize(),r.setLength(y.y-b.y),o.setLength(y.x-b.x),a.copy(r.add(o)),t.crossVectors(a,E).normalize(),e*=p.rotateSpeed,n.setFromAxisAngle(t,e),E.applyQuaternion(n),p.object.up.applyQuaternion(n),w.copy(t),R=e):!p.staticMoving&&R&&(R*=Math.sqrt(1-p.dynamicDampingFactor),E.copy(p.object.position).sub(p.target),n.setFromAxisAngle(w,R),E.applyQuaternion(n),p.object.up.applyQuaternion(n)),b.copy(y)}}(),this.zoomCamera=function(){var e;g===f.TOUCH_ZOOM_PAN?(e=H/k,H=k,E.multiplyScalar(e)):(e=1+(_.y-T.y)*p.zoomSpeed,1!==e&&e>0&&(E.multiplyScalar(e),p.staticMoving?T.copy(_):T.y+=(_.y-T.y)*this.dynamicDampingFactor))},this.panCamera=function(){var e=new THREE.Vector2,t=new THREE.Vector3,n=new THREE.Vector3;return function(){e.copy(O).sub(x),e.lengthSq()&&(e.multiplyScalar(E.length()*p.panSpeed),n.copy(E).cross(p.object.up).setLength(e.x),n.add(t.copy(p.object.up).setLength(e.y)),p.object.position.add(n),p.target.add(n),p.staticMoving?x.copy(O):x.add(e.subVectors(O,x).multiplyScalar(p.dynamicDampingFactor)))}}(),this.checkDistances=function(){p.noZoom&&p.noPan||(E.lengthSq()>p.maxDistance*p.maxDistance&&(p.object.position.addVectors(p.target,E.setLength(p.maxDistance)),T.copy(_)),E.lengthSq()<p.minDistance*p.minDistance&&(p.object.position.addVectors(p.target,E.setLength(p.minDistance)),T.copy(_)))},this.update=function(){E.subVectors(p.object.position,p.target),p.noRotate||p.rotateCamera(),p.noZoom||p.zoomCamera(),p.noPan||p.panCamera(),p.object.position.addVectors(p.target,E),p.checkDistances(),p.object.lookAt(p.target),m.distanceToSquared(p.object.position)>d&&(p.dispatchEvent(C),m.copy(p.object.position))},this.reset=function(){g=f.NONE,v=f.NONE,p.target.copy(p.target0),p.object.position.copy(p.position0),p.object.up.copy(p.up0),E.subVectors(p.object.position,p.target),p.object.lookAt(p.target),p.dispatchEvent(C),m.copy(p.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",h,!1),this.domElement.removeEventListener("mousedown",r,!1),this.domElement.removeEventListener("mousewheel",s,!1),this.domElement.removeEventListener("MozMousePixelScroll",s,!1),this.domElement.removeEventListener("touchstart",c,!1),this.domElement.removeEventListener("touchend",l,!1),this.domElement.removeEventListener("touchmove",u,!1),document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",a,!1),window.removeEventListener("keydown",n,!1),window.removeEventListener("keyup",i,!1)},this.domElement.addEventListener("contextmenu",h,!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("MozMousePixelScroll",s,!1),this.domElement.addEventListener("touchstart",c,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",u,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",i,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls,THREE.VRControls=function(e,t){function n(e){for(var n=0;n<e.length;n++)if("VRDisplay"in window&&e[n]instanceof VRDisplay||"PositionSensorVRDevice"in window&&e[n]instanceof PositionSensorVRDevice){i=e[n];break}i||t&&t("VR input not available.")}var i,r=this,o=new THREE.Matrix4;navigator.getVRDisplays?navigator.getVRDisplays().then(n):navigator.getVRDevices&&navigator.getVRDevices().then(n),this.scale=1,this.standing=!1,this.userHeight=1.6,this.update=function(){if(i){if(i.getPose){var t=i.getPose();null!==t.orientation&&e.quaternion.fromArray(t.orientation),null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0)}else{var n=i.getState();null!==n.orientation&&e.quaternion.copy(n.orientation),null!==n.position?e.position.copy(n.position):e.position.set(0,0,0)}this.standing&&(i.stageParameters?(e.updateMatrix(),o.fromArray(i.stageParameters.sittingToStandingTransform),e.applyMatrix(o)):e.position.setY(e.position.y+this.userHeight)),e.position.multiplyScalar(r.scale)}},this.resetPose=function(){i&&(void 0!==i.resetPose?i.resetPose():void 0!==i.resetSensor?i.resetSensor():void 0!==i.zeroSensor&&i.zeroSensor())},this.resetSensor=function(){console.warn("THREE.VRControls: .resetSensor() is now .resetPose()."),this.resetPose()},this.zeroSensor=function(){console.warn("THREE.VRControls: .zeroSensor() is now .resetPose()."),this.resetPose()},this.dispose=function(){i=null}},THREE.Bootstrap.registerPlugin("stats",{listen:["pre","post"],install:function(e){var t=this.stats=new THREE.Stats,n=t.domElement.style;n.position="absolute",n.top=n.left=0,e.element.appendChild(t.domElement),e.stats=t},uninstall:function(e){document.body.removeChild(this.stats.domElement),delete e.stats},pre:function(){this.stats.begin()},post:function(){this.stats.end()}}),THREE.Bootstrap.registerPlugin("controls",{listen:["update","resize","camera","this.change"],defaults:{klass:null,parameters:{}},install:function(e){if(!this.options.klass)throw"Must provide class for `controls.klass`";e.controls=null,this._camera=e.camera||new THREE.PerspectiveCamera,this.change(null,e)},uninstall:function(e){delete e.controls},change:function(e,t){this.options.klass?((!e||e.changes.klass)&&(t.controls=new this.options.klass(this._camera,t.renderer.domElement)),_.extend(t.controls,this.options.parameters)):t.controls=null},update:function(e,t){var n=t.Time&&t.Time.delta||1/60,i=t.VR&&t.VR.state;t.controls.vr&&t.controls.vr(i),t.controls.update(n)},camera:function(e,t){t.controls.object=this._camera=e.camera},resize:function(e,t){t.controls.handleResize&&t.controls.handleResize()}}),THREE.Bootstrap.registerPlugin("cursor",{listen:["update","this.change","install:change","uninstall:change","element.mousemove","vr"],defaults:{cursor:null,hide:!1,timeout:3},install:function(e){this.timeout=this.options.timeout,this.element=e.element,this.change(null,e)},uninstall:function(e){delete e.controls},change:function(e,t){this.applyCursor(t)},mousemove:function(e,t){this.options.hide&&(this.applyCursor(t),this.timeout=+this.options.timeout||0)},update:function(e,t){var n=t.Time&&t.Time.delta||1/60;this.options.hide&&(this.timeout-=n,this.timeout<0&&this.applyCursor(t,"none"))},vr:function(e,t){this.hide=e.active&&!e.hmd.fake,this.applyCursor(t)},applyCursor:function(e,t){var n=e.controls?"move":"";t=t||this.options.cursor||n,this.hide&&(t="none"),this.cursor!=t&&(this.element.style.cursor=t)}}),THREE.Bootstrap.registerPlugin("fullscreen",{defaults:{key:"f"},listen:["ready","update"],install:function(e){e.Fullscreen=this.api({active:!1,toggle:this.toggle.bind(this)},e)},uninstall:function(e){delete e.Fullscreen},ready:function(e,t){document.body.addEventListener("keypress",function(e){this.options.key&&e.charCode==this.options.key.charCodeAt(0)&&this.toggle(t)}.bind(this));var n=function(){var e=!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);t.Fullscreen.active=this.active=e,t.trigger({type:"fullscreen",active:e})}.bind(this);document.addEventListener("fullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1)},toggle:function(e){var t=e.canvas,n=e.VR&&e.VR.active?{vrDisplay:e.VR.hmd}:{};this.active?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():t.requestFullScreen?t.requestFullScreen(n):t.msRequestFullScreen?t.msRequestFullscreen(n):t.webkitRequestFullscreen?t.webkitRequestFullscreen(n):t.mozRequestFullScreen&&t.mozRequestFullScreen(n)}}),THREE.Bootstrap.registerPlugin("vr",{defaults:{mode:"auto",device:null,fov:80},listen:["window.load","pre","render","resize","this.change"],install:function(e){e.VR=this.api({active:!1,devices:[],hmd:null,sensor:null,renderer:null,state:null},e)},uninstall:function(e){delete e.VR},mocks:function(e,t,n){var i=.03,r=function(e){return{left:{x:-i,y:0,z:0},right:{x:i,y:0,z:0}}[e]},o=function(i){var r=e.camera,o=r&&r.aspect||16/9,a=(t||r&&r.fov||n)/2,s=180*Math.atan(Math.tan(a*Math.PI/180)*o/2)/Math.PI,c=a;return{left:{rightDegrees:s,leftDegrees:s,downDegrees:c,upDegrees:c},right:{rightDegrees:s,leftDegrees:s,downDegrees:c,upDegrees:c}}[i]},a=function(){return{}};return[{fake:!0,force:1,deviceId:"emu",deviceName:"Emulated",getEyeTranslation:r,getRecommendedEyeFieldOfView:o},{force:2,getState:a}]},load:function(e,t){var n=function(e){this.callback(e,t)}.bind(this);navigator.getVRDevices?navigator.getVRDevices().then(n):navigator.mozGetVRDevices?navigator.mozGetVRDevices(n):(console.warn("No native VR support detected."),n(this.mocks(t,this.options.fov,this.defaults.fov),t))},callback:function(e,t){var n,i,r=window.HMDVRDevice||function(){},o=window.PositionSensorVRDevice||function(){};e=t.VR.devices=e||t.VR.devices;for(var a=this.options.device,s=0;s<e.length;++s){var c=e[s];if(1==c.force||c instanceof r){if(a&&a!=c.deviceId)continue;n=c;break}}if(n){for(var s=0;s<e.length;++s){var c=e[s];if(2==c.force||c instanceof o&&c.hardwareUnitId==n.hardwareUnitId){i=c;break}}this.hookup(n,i,t)}},hookup:function(e,t,n){THREE.VRRenderer||console.log("THREE.VRRenderer not found");var i=THREE.VRRenderer||function(){};this.renderer=new i(n.renderer,e),this.hmd=e,this.sensor=t,n.VR.renderer=this.renderer,n.VR.hmd=e,n.VR.sensor=t,console.log("THREE.VRRenderer",e.deviceName)},change:function(e,t){e.changes.device&&this.callback(null,t),this.pre(e,t)},pre:function(e,t){var n=this.active,i=this.active=this.renderer&&"2d"!=this.options.mode;if(t.VR.active=i,i&&this.sensor){var r=this.sensor.getState();t.VR.state=r}else t.VR.state=null;n!=this.active&&t.trigger({type:"vr",active:i,hmd:this.hmd,sensor:this.sensor})},resize:function(){this.active&&this.renderer.initialize()},render:function(e,t){if(t.scene&&t.camera){var n=this.active?this.renderer:t.renderer;if(this.last!=n&&n==t.renderer){var i=n.getPixelRatio(),r=n.domElement.width/i,o=n.domElement.height/i;n.enableScissorTest(!1),n.setViewport(0,0,r,o)}this.last=n,n.render(t.scene,t.camera)}}}),THREE.Bootstrap.registerPlugin("ui",{defaults:{theme:"white",style:".threestrap-ui { position: absolute; bottom: 5px; right: 5px; float: left; }.threestrap-ui button { border: 0; background: none;  vertical-align: middle; font-weight: bold; } .threestrap-ui .glyphicon { top: 2px; font-weight: bold; } @media (max-width: 640px) { .threestrap-ui button { font-size: 120% } }.threestrap-white button { color: #fff; text-shadow: 0 1px 1px rgba(0, 0, 0, 1), 0 1px 3px rgba(0, 0, 0, 1); }.threestrap-black button { color: #000; text-shadow: 0 0px 1px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1) }"},listen:["fullscreen"],markup:function(e,t,n){var i="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css";location.href.match(/^file:\/\//)&&(i="http://"+i);var r=[];return e.Fullscreen&&r.push('<button class="fullscreen" title="Full Screen"><span class="glyphicon glyphicon-fullscreen"></span></button>'),e.VR&&r.push('<button class="vr" title="VR Headset">VR</button>'),'<style type="text/css">@import url("'+i+'"); '+n+'</style><div class="threestrap-ui threestrap-'+t+'">'+r.join("\n")+"</div>"},install:function(e){var t=this.ui=document.createElement("div");t.innerHTML=this.markup(e,this.options.theme,this.options.style),document.body.appendChild(t);var n=this.ui.fullscreen=t.querySelector("button.fullscreen");n&&e.bind([n,"click:goFullscreen"],this);var i=this.ui.vr=t.querySelector("button.vr");i&&(e.VR.set({mode:"2d"}),e.bind([i,"click:goVR"],this))},uninstall:function(){document.body.removeChild(ui)},fullscreen:function(e,t){this.ui.style.display=e.active?"none":"block",e.active||t.VR.set({mode:"2d"})},goFullscreen:function(e,t){t.Fullscreen&&t.Fullscreen.toggle()},goVR:function(e,t){t.VR&&(t.VR.set({mode:"auto"}),t.Fullscreen.toggle())},uninstall:function(){document.body.removeChild(this.ui)}});