(function(){function t(t,e,n){for(var i=(n||0)-1,r=t?t.length:0;++i<r;)if(t[i]===e)return i;return-1}function e(e,n){var i=typeof n;if(e=e.cache,"boolean"==i||null==n)return e[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:g+n;return e=(e=e[i])&&e[r],"object"==i?e&&t(e,n)>-1?0:-1:e?0:-1}function n(t){var e=this.cache,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?t:g+t,r=e[n]||(e[n]={});"object"==n?(r[i]||(r[i]=[])).push(t):r[i]=!0}}function i(t){return t.charCodeAt(0)}function r(t,e){for(var n=t.criteria,i=e.criteria,r=-1,o=n.length;++r<o;){var a=n[r],s=i[r];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return t.index-e.index}function o(t){var e=-1,i=t.length,r=t[0],o=t[i/2|0],a=t[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=u();s["false"]=s["null"]=s["true"]=s.undefined=!1;var l=u();for(l.array=t,l.cache=s,l.push=n;++e<i;)l.push(t[e]);return l}function a(t){return"\\"+X[t]}function s(){return d.pop()||[]}function u(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(t){t.length=0,d.length<b&&d.push(t)}function c(t){var e=t.cache;e&&c(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,m.length<b&&m.push(t)}function h(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var i=-1,r=n-e||0,o=Array(0>r?0:r);++i<r;)o[i]=t[e+i];return o}function f(n){function d(t){return t&&"object"==typeof t&&!Qn(t)&&Ln.call(t,"__wrapped__")?t:new m(t)}function m(t,e){this.__chain__=!!e,this.__wrapped__=t}function b(t){function e(){if(i){var t=h(i);Vn.apply(t,arguments)}if(this instanceof e){var o=G(n.prototype),a=n.apply(o,t||arguments);return jt(a)?a:o}return n.apply(r,t||arguments)}var n=t[0],i=t[2],r=t[4];return Kn(e,t),e}function X(t,e,n,i,r){if(n){var o=n(t);if("undefined"!=typeof o)return o}var a=jt(t);if(!a)return t;var u=Hn.call(t);if(!Y[u])return t;var c=Gn[u];switch(u){case z:case B:return new c(+t);case F:case I:return new c(t);case N:return o=c(t.source,k.exec(t)),o.lastIndex=t.lastIndex,o}var f=Qn(t);if(e){var p=!i;i||(i=s()),r||(r=s());for(var d=i.length;d--;)if(i[d]==t)return r[d];o=f?c(t.length):{}}else o=f?h(t):oi({},t);return f&&(Ln.call(t,"index")&&(o.index=t.index),Ln.call(t,"input")&&(o.input=t.input)),e?(i.push(t),r.push(o),(f?Zt:ui)(t,function(t,a){o[a]=X(t,e,n,i,r)}),p&&(l(i),l(r)),o):o}function G(t,e){return jt(t)?An(t):{}}function Z(t,e,n){if("function"!=typeof t)return Ke;if("undefined"==typeof e||!("prototype"in t))return t;var i=t.__bindData__;if("undefined"==typeof i&&(Zn.funcNames&&(i=!t.name),i=i||!Zn.funcDecomp,!i)){var r=Pn.call(t);Zn.funcNames||(i=!x.test(r)),i||(i=j.test(r),Kn(t,i))}if(i===!1||i!==!0&&1&i[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return Le(t,e)}function K(t){function e(){var t=u?a:this;if(r){var d=h(r);Vn.apply(d,arguments)}if((o||c)&&(d||(d=h(arguments)),o&&Vn.apply(d,o),c&&d.length<s))return i|=16,K([n,f?i:-4&i,d,null,a,s]);if(d||(d=arguments),l&&(n=t[p]),this instanceof e){t=G(n.prototype);var m=n.apply(t,d);return jt(m)?m:t}return n.apply(t,d)}var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=1&i,l=2&i,c=4&i,f=8&i,p=n;return Kn(e,t),e}function Q(n,i){var r=-1,a=ut(),s=n?n.length:0,u=s>=y&&a===t,l=[];if(u){var h=o(i);h?(a=e,i=h):u=!1}for(;++r<s;){var f=n[r];a(i,f)<0&&l.push(f)}return u&&c(i),l}function tt(t,e,n,i){for(var r=(i||0)-1,o=t?t.length:0,a=[];++r<o;){var s=t[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Qn(s)||ft(s))){e||(s=tt(s,e,n));var u=-1,l=s.length,c=a.length;for(a.length+=l;++u<l;)a[c++]=s[u]}else n||a.push(s)}return a}function et(t,e,n,i,r,o){if(n){var a=n(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;var u=typeof t,c=typeof e;if(!(t!==t||t&&W[u]||e&&W[c]))return!1;if(null==t||null==e)return t===e;var h=Hn.call(t),f=Hn.call(e);if(h==L&&(h=A),f==L&&(f=A),h!=f)return!1;switch(h){case z:case B:return+t==+e;case F:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case N:case I:return t==_n(e)}var p=h==V;if(!p){var d=Ln.call(t,"__wrapped__"),m=Ln.call(e,"__wrapped__");if(d||m)return et(d?t.__wrapped__:t,m?e.__wrapped__:e,n,i,r,o);if(h!=A)return!1;var v=t.constructor,g=e.constructor;if(v!=g&&!(Ct(v)&&v instanceof v&&Ct(g)&&g instanceof g)&&"constructor"in t&&"constructor"in e)return!1}var y=!r;r||(r=s()),o||(o=s());for(var b=r.length;b--;)if(r[b]==t)return o[b]==e;var E=0;if(a=!0,r.push(t),o.push(e),p){if(b=t.length,E=e.length,a=E==b,a||i)for(;E--;){var w=b,_=e[E];if(i)for(;w--&&!(a=et(t[w],_,n,i,r,o)););else if(!(a=et(t[E],_,n,i,r,o)))break}}else si(e,function(e,s,u){return Ln.call(u,s)?(E++,a=Ln.call(t,s)&&et(t[s],e,n,i,r,o)):void 0}),a&&!i&&si(t,function(t,e,n){return Ln.call(n,e)?a=--E>-1:void 0});return r.pop(),o.pop(),y&&(l(r),l(o)),a}function nt(t,e,n,i,r){(Qn(e)?Zt:ui)(e,function(e,o){var a,s,u=e,l=t[o];if(e&&((s=Qn(e))||li(e))){for(var c=i.length;c--;)if(a=i[c]==e){l=r[c];break}if(!a){var h;n&&(u=n(l,e),(h="undefined"!=typeof u)&&(l=u)),h||(l=s?Qn(l)?l:[]:li(l)?l:{}),i.push(e),r.push(l),h||nt(l,e,n,i,r)}}else n&&(u=n(l,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(l=u);t[o]=l})}function it(t,e){return t+On($n()*(e-t+1))}function rt(n,i,r){var a=-1,u=ut(),h=n?n.length:0,f=[],p=!i&&h>=y&&u===t,d=r||p?s():f;if(p){var m=o(d);u=e,d=m}for(;++a<h;){var v=n[a],g=r?r(v,a,n):v;(i?!a||d[d.length-1]!==g:u(d,g)<0)&&((r||p)&&d.push(g),f.push(v))}return p?(l(d.array),c(d)):r&&l(d),f}function ot(t){return function(e,n,i){var r={};n=d.createCallback(n,i,3);var o=-1,a=e?e.length:0;if("number"==typeof a)for(;++o<a;){var s=e[o];t(r,s,n(s,o,e),e)}else ui(e,function(e,i,o){t(r,e,n(e,i,o),o)});return r}}function at(t,e,n,i,r,o){var a=1&e,s=2&e,u=4&e,l=16&e,c=32&e;if(!s&&!Ct(t))throw new Rn;l&&!n.length&&(e&=-17,l=n=!1),c&&!i.length&&(e&=-33,c=i=!1);var f=t&&t.__bindData__;if(f&&f!==!0)return f=h(f),f[2]&&(f[2]=h(f[2])),f[3]&&(f[3]=h(f[3])),!a||1&f[1]||(f[4]=r),!a&&1&f[1]&&(e|=8),!u||4&f[1]||(f[5]=o),l&&Vn.apply(f[2]||(f[2]=[]),n),c&&Dn.apply(f[3]||(f[3]=[]),i),f[1]|=e,at.apply(null,f);var p=1==e||17===e?b:K;return p([t,e,n,i,r,o])}function st(t){return ei[t]}function ut(){var e=(e=d.indexOf)===ge?t:e;return e}function lt(t){return"function"==typeof t&&Mn.test(t)}function ct(t){var e,n;return t&&Hn.call(t)==A&&(e=t.constructor,!Ct(e)||e instanceof e)?(si(t,function(t,e){n=e}),"undefined"==typeof n||Ln.call(t,n)):!1}function ht(t){return ni[t]}function ft(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Hn.call(t)==L||!1}function pt(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n=e,e=!1),X(t,e,"function"==typeof n&&Z(n,i,1))}function dt(t,e,n){return X(t,!0,"function"==typeof e&&Z(e,n,1))}function mt(t,e){var n=G(t);return e?oi(n,e):n}function vt(t,e,n){var i;return e=d.createCallback(e,n,3),ui(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function gt(t,e,n){var i;return e=d.createCallback(e,n,3),bt(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function yt(t,e,n){var i=[];si(t,function(t,e){i.push(e,t)});var r=i.length;for(e=Z(e,n,3);r--&&e(i[r--],i[r],t)!==!1;);return t}function bt(t,e,n){var i=ti(t),r=i.length;for(e=Z(e,n,3);r--;){var o=i[r];if(e(t[o],o,t)===!1)break}return t}function Et(t){var e=[];return si(t,function(t,n){Ct(t)&&e.push(n)}),e.sort()}function wt(t,e){return t?Ln.call(t,e):!1}function _t(t){for(var e=-1,n=ti(t),i=n.length,r={};++e<i;){var o=n[e];r[t[o]]=o}return r}function Rt(t){return t===!0||t===!1||t&&"object"==typeof t&&Hn.call(t)==z||!1}function Tt(t){return t&&"object"==typeof t&&Hn.call(t)==B||!1}function kt(t){return t&&1===t.nodeType||!1}function xt(t){var e=!0;if(!t)return e;var n=Hn.call(t),i=t.length;return n==V||n==I||n==L||n==A&&"number"==typeof i&&Ct(t.splice)?!i:(ui(t,function(){return e=!1}),e)}function Ht(t,e,n,i){return et(t,e,"function"==typeof n&&Z(n,i,2))}function Mt(t){return In(t)&&!Yn(parseFloat(t))}function Ct(t){return"function"==typeof t}function jt(t){return!(!t||!W[typeof t])}function Ot(t){return St(t)&&t!=+t}function Pt(t){return null===t}function St(t){return"number"==typeof t||t&&"object"==typeof t&&Hn.call(t)==F||!1}function Lt(t){return t&&"object"==typeof t&&Hn.call(t)==N||!1}function Vt(t){return"string"==typeof t||t&&"object"==typeof t&&Hn.call(t)==I||!1}function zt(t){return"undefined"==typeof t}function Bt(t,e,n){var i={};return e=d.createCallback(e,n,3),ui(t,function(t,n,r){i[n]=e(t,n,r)}),i}function Dt(t){var e=arguments,n=2;if(!jt(t))return t;if("number"!=typeof e[2]&&(n=e.length),n>3&&"function"==typeof e[n-2])var i=Z(e[--n-1],e[n--],2);else n>2&&"function"==typeof e[n-1]&&(i=e[--n]);for(var r=h(arguments,1,n),o=-1,a=s(),u=s();++o<n;)nt(t,r[o],i,a,u);return l(a),l(u),t}function Ft(t,e,n){var i={};if("function"!=typeof e){var r=[];si(t,function(t,e){r.push(e)}),r=Q(r,tt(arguments,!0,!1,1));for(var o=-1,a=r.length;++o<a;){var s=r[o];i[s]=t[s]}}else e=d.createCallback(e,n,3),si(t,function(t,n,r){e(t,n,r)||(i[n]=t)});return i}function At(t){for(var e=-1,n=ti(t),i=n.length,r=dn(i);++e<i;){var o=n[e];r[e]=[o,t[o]]}return r}function Nt(t,e,n){var i={};if("function"!=typeof e)for(var r=-1,o=tt(arguments,!0,!1,1),a=jt(t)?o.length:0;++r<a;){var s=o[r];s in t&&(i[s]=t[s])}else e=d.createCallback(e,n,3),si(t,function(t,n,r){e(t,n,r)&&(i[n]=t)});return i}function It(t,e,n,i){var r=Qn(t);if(null==n)if(r)n=[];else{var o=t&&t.constructor,a=o&&o.prototype;n=G(a)}return e&&(e=d.createCallback(e,i,4),(r?Zt:ui)(t,function(t,i,r){return e(n,t,i,r)})),n}function Yt(t){for(var e=-1,n=ti(t),i=n.length,r=dn(i);++e<i;)r[e]=t[n[e]];return r}function qt(t){for(var e=arguments,n=-1,i=tt(e,!0,!1,1),r=e[2]&&e[2][e[1]]===t?1:i.length,o=dn(r);++n<r;)o[n]=t[i[n]];return o}function Ut(t,e,n){var i=-1,r=ut(),o=t?t.length:0,a=!1;return n=(0>n?Un(0,o+n):n)||0,Qn(t)?a=r(t,e,n)>-1:"number"==typeof o?a=(Vt(t)?t.indexOf(e,n):r(t,e,n))>-1:ui(t,function(t){return++i>=n?!(a=t===e):void 0}),a}function Wt(t,e,n){var i=!0;e=d.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&(i=!!e(t[r],r,t)););else ui(t,function(t,n,r){return i=!!e(t,n,r)});return i}function Xt(t,e,n){var i=[];e=d.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o;){var a=t[r];e(a,r,t)&&i.push(a)}else ui(t,function(t,n,r){e(t,n,r)&&i.push(t)});return i}function $t(t,e,n){e=d.createCallback(e,n,3);var i=-1,r=t?t.length:0;if("number"!=typeof r){var o;return ui(t,function(t,n,i){return e(t,n,i)?(o=t,!1):void 0}),o}for(;++i<r;){var a=t[i];if(e(a,i,t))return a}}function Gt(t,e,n){var i;return e=d.createCallback(e,n,3),Kt(t,function(t,n,r){return e(t,n,r)?(i=t,!1):void 0}),i}function Zt(t,e,n){var i=-1,r=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Z(e,n,3),"number"==typeof r)for(;++i<r&&e(t[i],i,t)!==!1;);else ui(t,e);return t}function Kt(t,e,n){var i=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Z(e,n,3),"number"==typeof i)for(;i--&&e(t[i],i,t)!==!1;);else{var r=ti(t);i=r.length,ui(t,function(t,n,o){return n=r?r[--i]:--i,e(o[n],n,o)})}return t}function Qt(t,e){var n=h(arguments,2),i=-1,r="function"==typeof e,o=t?t.length:0,a=dn("number"==typeof o?o:0);return Zt(t,function(t){a[++i]=(r?e:t[e]).apply(t,n)}),a}function Jt(t,e,n){var i=-1,r=t?t.length:0;if(e=d.createCallback(e,n,3),"number"==typeof r)for(var o=dn(r);++i<r;)o[i]=e(t[i],i,t);else o=[],ui(t,function(t,n,r){o[++i]=e(t,n,r)});return o}function te(t,e,n){var r=-(1/0),o=r;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Qn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];u>o&&(o=u)}else e=null==e&&Vt(t)?i:d.createCallback(e,n,3),Zt(t,function(t,n,i){var a=e(t,n,i);a>r&&(r=a,o=t)});return o}function ee(t,e,n){var r=1/0,o=r;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Qn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];o>u&&(o=u)}else e=null==e&&Vt(t)?i:d.createCallback(e,n,3),Zt(t,function(t,n,i){var a=e(t,n,i);r>a&&(r=a,o=t)});return o}function ne(t,e,n,i){if(!t)return n;var r=arguments.length<3;e=d.createCallback(e,i,4);var o=-1,a=t.length;if("number"==typeof a)for(r&&(n=t[++o]);++o<a;)n=e(n,t[o],o,t);else ui(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)});return n}function ie(t,e,n,i){var r=arguments.length<3;return e=d.createCallback(e,i,4),Kt(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function re(t,e,n){return e=d.createCallback(e,n,3),Xt(t,function(t,n,i){return!e(t,n,i)})}function oe(t,e,n){if(t&&"number"!=typeof t.length&&(t=Yt(t)),null==e||n)return t?t[it(0,t.length-1)]:p;var i=ae(t);return i.length=Wn(Un(0,e),i.length),i}function ae(t){var e=-1,n=t?t.length:0,i=dn("number"==typeof n?n:0);return Zt(t,function(t){var n=it(0,++e);i[e]=i[n],i[n]=t}),i}function se(t){var e=t?t.length:0;return"number"==typeof e?e:ti(t).length}function ue(t,e,n){var i;e=d.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&!(i=e(t[r],r,t)););else ui(t,function(t,n,r){return!(i=e(t,n,r))});return!!i}function le(t,e,n){var i=-1,o=Qn(e),a=t?t.length:0,h=dn("number"==typeof a?a:0);for(o||(e=d.createCallback(e,n,3)),Zt(t,function(t,n,r){var a=h[++i]=u();o?a.criteria=Jt(e,function(e){return t[e]}):(a.criteria=s())[0]=e(t,n,r),a.index=i,a.value=t}),a=h.length,h.sort(r);a--;){var f=h[a];h[a]=f.value,o||l(f.criteria),c(f)}return h}function ce(t){return t&&"number"==typeof t.length?h(t):Yt(t)}function he(t){for(var e=-1,n=t?t.length:0,i=[];++e<n;){var r=t[e];r&&i.push(r)}return i}function fe(t){return Q(t,tt(arguments,!0,!0,1))}function pe(t,e,n){var i=-1,r=t?t.length:0;for(e=d.createCallback(e,n,3);++i<r;)if(e(t[i],i,t))return i;return-1}function de(t,e,n){var i=t?t.length:0;for(e=d.createCallback(e,n,3);i--;)if(e(t[i],i,t))return i;return-1}function me(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=d.createCallback(e,n,3);++o<r&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[0]:p;return h(t,0,Wn(Un(0,i),r))}function ve(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n="function"!=typeof e&&i&&i[e]===t?null:e,e=!1),null!=n&&(t=Jt(t,n,i)),tt(t,e)}function ge(e,n,i){if("number"==typeof i){var r=e?e.length:0;i=0>i?Un(0,r+i):i||0}else if(i){var o=xe(e,n);return e[o]===n?o:-1}return t(e,n,i)}function ye(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=d.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else i=null==e||n?1:e||i;return h(t,0,Wn(Un(0,r-i),r))}function be(){for(var n=[],i=-1,r=arguments.length,a=s(),u=ut(),h=u===t,f=s();++i<r;){var p=arguments[i];(Qn(p)||ft(p))&&(n.push(p),a.push(h&&p.length>=y&&o(i?n[i]:f)))}var d=n[0],m=-1,v=d?d.length:0,g=[];t:for(;++m<v;){var b=a[0];if(p=d[m],(b?e(b,p):u(f,p))<0){for(i=r,(b||f).push(p);--i;)if(b=a[i],(b?e(b,p):u(n[i],p))<0)continue t;g.push(p)}}for(;r--;)b=a[r],b&&c(b);return l(a),l(f),g}function Ee(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=d.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[r-1]:p;return h(t,Un(0,r-i))}function we(t,e,n){var i=t?t.length:0;for("number"==typeof n&&(i=(0>n?Un(0,i+n):Wn(n,i-1))+1);i--;)if(t[i]===e)return i;return-1}function _e(t){for(var e=arguments,n=0,i=e.length,r=t?t.length:0;++n<i;)for(var o=-1,a=e[n];++o<r;)t[o]===a&&(Bn.call(t,o--,1),r--);return t}function Re(t,e,n){t=+t||0,n="number"==typeof n?n:+n||1,null==e&&(e=t,t=0);for(var i=-1,r=Un(0,Cn((e-t)/(n||1))),o=dn(r);++i<r;)o[i]=t,t+=n;return o}function Te(t,e,n){var i=-1,r=t?t.length:0,o=[];for(e=d.createCallback(e,n,3);++i<r;){var a=t[i];e(a,i,t)&&(o.push(a),Bn.call(t,i--,1),r--)}return o}function ke(t,e,n){if("number"!=typeof e&&null!=e){var i=0,r=-1,o=t?t.length:0;for(e=d.createCallback(e,n,3);++r<o&&e(t[r],r,t);)i++}else i=null==e||n?1:Un(0,e);return h(t,i)}function xe(t,e,n,i){var r=0,o=t?t.length:r;for(n=n?d.createCallback(n,i,1):Ke,e=n(e);o>r;){var a=r+o>>>1;n(t[a])<e?r=a+1:o=a}return r}function He(){return rt(tt(arguments,!0,!0))}function Me(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n="function"!=typeof e&&i&&i[e]===t?null:e,e=!1),null!=n&&(n=d.createCallback(n,i,3)),rt(t,e,n)}function Ce(t){return Q(t,h(arguments,1))}function je(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Qn(n)||ft(n))var i=i?rt(Q(i,n).concat(Q(n,i))):n}return i||[]}function Oe(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,n=t?te(pi(t,"length")):0,i=dn(0>n?0:n);++e<n;)i[e]=pi(t,e);return i}function Pe(t,e){var n=-1,i=t?t.length:0,r={};for(e||!i||Qn(t[0])||(e=[]);++n<i;){var o=t[n];e?r[o]=e[n]:o&&(r[o[0]]=o[1])}return r}function Se(t,e){if(!Ct(e))throw new Rn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Le(t,e){return arguments.length>2?at(t,17,h(arguments,2),null,e):at(t,1,null,null,e)}function Ve(t){for(var e=arguments.length>1?tt(arguments,!0,!1,1):Et(t),n=-1,i=e.length;++n<i;){var r=e[n];t[r]=at(t[r],1,null,null,t)}return t}function ze(t,e){return arguments.length>2?at(e,19,h(arguments,2),null,t):at(e,3,null,null,t)}function Be(){for(var t=arguments,e=t.length;e--;)if(!Ct(t[e]))throw new Rn;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function De(t,e){return e="number"==typeof e?e:+e||t.length,at(t,4,null,null,null,e)}function Fe(t,e,n){var i,r,o,a,s,u,l,c=0,h=!1,f=!0;if(!Ct(t))throw new Rn;if(e=Un(0,e)||0,n===!0){var d=!0;f=!1}else jt(n)&&(d=n.leading,h="maxWait"in n&&(Un(e,n.maxWait)||0),f="trailing"in n?n.trailing:f);var m=function(){var n=e-(mi()-a);if(0>=n){r&&jn(r);var h=l;r=u=l=p,h&&(c=mi(),o=t.apply(s,i),u||r||(i=s=null))}else u=zn(m,n)},v=function(){u&&jn(u),r=u=l=p,(f||h!==e)&&(c=mi(),o=t.apply(s,i),u||r||(i=s=null))};return function(){if(i=arguments,a=mi(),s=this,l=f&&(u||!d),h===!1)var n=d&&!u;else{r||d||(c=a);var p=h-(a-c),g=0>=p;g?(r&&(r=jn(r)),c=a,o=t.apply(s,i)):r||(r=zn(v,p))}return g&&u?u=jn(u):u||e===h||(u=zn(m,e)),n&&(g=!0,o=t.apply(s,i)),!g||u||r||(i=s=null),o}}function Ae(t){if(!Ct(t))throw new Rn;var e=h(arguments,1);return zn(function(){t.apply(p,e)},1)}function Ne(t,e){if(!Ct(t))throw new Rn;var n=h(arguments,2);return zn(function(){t.apply(p,n)},e)}function Ie(t,e){if(!Ct(t))throw new Rn;var n=function(){var i=n.cache,r=e?e.apply(this,arguments):g+arguments[0];return Ln.call(i,r)?i[r]:i[r]=t.apply(this,arguments)};return n.cache={},n}function Ye(t){var e,n;if(!Ct(t))throw new Rn;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function qe(t){return at(t,16,h(arguments,1))}function Ue(t){return at(t,32,null,h(arguments,1))}function We(t,e,n){var i=!0,r=!0;if(!Ct(t))throw new Rn;return n===!1?i=!1:jt(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),q.leading=i,q.maxWait=e,q.trailing=r,Fe(t,e,q)}function Xe(t,e){return at(e,16,[t])}function $e(t){return function(){return t}}function Ge(t,e,n){var i=typeof t;if(null==t||"function"==i)return Z(t,e,n);if("object"!=i)return en(t);var r=ti(t),o=r[0],a=t[o];return 1!=r.length||a!==a||jt(a)?function(e){for(var n=r.length,i=!1;n--&&(i=et(e[r[n]],t[r[n]],null,!0)););return i}:function(t){var e=t[o];return a===e&&(0!==a||1/a==1/e)}}function Ze(t){return null==t?"":_n(t).replace(ri,st)}function Ke(t){return t}function Qe(t,e,n){var i=!0,r=e&&Et(e);e&&(n||r.length)||(null==n&&(n=e),o=m,e=t,t=d,r=Et(e)),n===!1?i=!1:jt(n)&&"chain"in n&&(i=n.chain);var o=t,a=Ct(o);Zt(r,function(n){var r=t[n]=e[n];a&&(o.prototype[n]=function(){var e=this.__chain__,n=this.__wrapped__,a=[n];Vn.apply(a,arguments);var s=r.apply(t,a);if(i||e){if(n===s&&jt(s))return this;s=new o(s),s.__chain__=e}return s})})}function Je(){return n._=xn,this}function tn(){}function en(t){return function(e){return e[t]}}function nn(t,e,n){var i=null==t,r=null==e;if(null==n&&("boolean"==typeof t&&r?(n=t,t=1):r||"boolean"!=typeof e||(n=e,r=!0)),i&&r&&(e=1),t=+t||0,r?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=$n();return Wn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return it(t,e)}function rn(t,e){if(t){var n=t[e];return Ct(n)?t[e]():n}}function on(t,e,n){var i=d.templateSettings;t=_n(t||""),n=ai({},n,i);var r,o=ai({},n.imports,i.imports),s=ti(o),u=Yt(o),l=0,c=n.interpolate||C,h="__p += '",f=wn((n.escape||C).source+"|"+c.source+"|"+(c===H?T:C).source+"|"+(n.evaluate||C).source+"|$","g");t.replace(f,function(e,n,i,o,s,u){return i||(i=o),h+=t.slice(l,u).replace(O,a),n&&(h+="' +\n__e("+n+") +\n'"),s&&(r=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),h+="';\n";var m=n.variable,v=m;v||(m="obj",h="with ("+m+") {\n"+h+"\n}\n"),h=(r?h.replace(w,""):h).replace(_,"$1").replace(R,"$1;"),h="function("+m+") {\n"+(v?"":m+" || ("+m+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+S++ +"]")+"\n*/";try{var y=gn(s,"return "+h+g).apply(p,u)}catch(b){throw b.source=h,b}return e?y(e):(y.source=h,y)}function an(t,e,n){t=(t=+t)>-1?t:0;var i=-1,r=dn(t);for(e=Z(e,n,1);++i<t;)r[i]=e(i);return r}function sn(t){return null==t?"":_n(t).replace(ii,ht)}function un(t){var e=++v;return _n(null==t?"":t)+e}function ln(t){return t=new m(t),t.__chain__=!0,t}function cn(t,e){return e(t),t}function hn(){return this.__chain__=!0,this}function fn(){return _n(this.__wrapped__)}function pn(){return this.__wrapped__}n=n?J.defaults($.Object(),n,J.pick($,P)):$;var dn=n.Array,mn=n.Boolean,vn=n.Date,gn=n.Function,yn=n.Math,bn=n.Number,En=n.Object,wn=n.RegExp,_n=n.String,Rn=n.TypeError,Tn=[],kn=En.prototype,xn=n._,Hn=kn.toString,Mn=wn("^"+_n(Hn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Cn=yn.ceil,jn=n.clearTimeout,On=yn.floor,Pn=gn.prototype.toString,Sn=lt(Sn=En.getPrototypeOf)&&Sn,Ln=kn.hasOwnProperty,Vn=Tn.push,zn=n.setTimeout,Bn=Tn.splice,Dn=Tn.unshift,Fn=function(){try{var t={},e=lt(e=En.defineProperty)&&e,n=e(t,t,t)&&e}catch(i){}return n}(),An=lt(An=En.create)&&An,Nn=lt(Nn=dn.isArray)&&Nn,In=n.isFinite,Yn=n.isNaN,qn=lt(qn=En.keys)&&qn,Un=yn.max,Wn=yn.min,Xn=n.parseInt,$n=yn.random,Gn={};Gn[V]=dn,Gn[z]=mn,Gn[B]=vn,Gn[D]=gn,Gn[A]=En,Gn[F]=bn,Gn[N]=wn,Gn[I]=_n,m.prototype=d.prototype;var Zn=d.support={};Zn.funcDecomp=!lt(n.WinRTError)&&j.test(f),Zn.funcNames="string"==typeof gn.name,d.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:H,variable:"",imports:{_:d}},An||(G=function(){function t(){}return function(e){if(jt(e)){t.prototype=e;var i=new t;t.prototype=null}return i||n.Object()}}());var Kn=Fn?function(t,e){U.value=e,Fn(t,"__bindData__",U),U.value=null}:tn,Qn=Nn||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Hn.call(t)==V||!1},Jn=function(t){var e,n=t,i=[];if(!n)return i;if(!W[typeof t])return i;for(e in n)Ln.call(n,e)&&i.push(e);return i},ti=qn?function(t){return jt(t)?qn(t):[]}:Jn,ei={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ni=_t(ei),ii=wn("("+ti(ni).join("|")+")","g"),ri=wn("["+ti(ei).join("")+"]","g"),oi=function(t,e,n){var i,r=t,o=r;if(!r)return o;var a=arguments,s=0,u="number"==typeof n?2:a.length;if(u>3&&"function"==typeof a[u-2])var l=Z(a[--u-1],a[u--],2);else u>2&&"function"==typeof a[u-1]&&(l=a[--u]);for(;++s<u;)if(r=a[s],r&&W[typeof r])for(var c=-1,h=W[typeof r]&&ti(r),f=h?h.length:0;++c<f;)i=h[c],o[i]=l?l(o[i],r[i]):r[i];return o},ai=function(t,e,n){var i,r=t,o=r;if(!r)return o;for(var a=arguments,s=0,u="number"==typeof n?2:a.length;++s<u;)if(r=a[s],r&&W[typeof r])for(var l=-1,c=W[typeof r]&&ti(r),h=c?c.length:0;++l<h;)i=c[l],"undefined"==typeof o[i]&&(o[i]=r[i]);return o},si=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!W[typeof r])return o;e=e&&"undefined"==typeof n?e:Z(e,n,3);for(i in r)if(e(r[i],i,t)===!1)return o;return o},ui=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!W[typeof r])return o;e=e&&"undefined"==typeof n?e:Z(e,n,3);for(var a=-1,s=W[typeof r]&&ti(r),u=s?s.length:0;++a<u;)if(i=s[a],e(r[i],i,t)===!1)return o;return o},li=Sn?function(t){if(!t||Hn.call(t)!=A)return!1;var e=t.valueOf,n=lt(e)&&(n=Sn(e))&&Sn(n);return n?t==n||Sn(t)==n:ct(t)}:ct,ci=ot(function(t,e,n){Ln.call(t,n)?t[n]++:t[n]=1}),hi=ot(function(t,e,n){(Ln.call(t,n)?t[n]:t[n]=[]).push(e)}),fi=ot(function(t,e,n){t[n]=e}),pi=Jt,di=Xt,mi=lt(mi=vn.now)&&mi||function(){return(new vn).getTime()},vi=8==Xn(E+"08")?Xn:function(t,e){return Xn(Vt(t)?t.replace(M,""):t,e||0)};return d.after=Se,d.assign=oi,d.at=qt,d.bind=Le,d.bindAll=Ve,d.bindKey=ze,d.chain=ln,d.compact=he,d.compose=Be,d.constant=$e,d.countBy=ci,d.create=mt,d.createCallback=Ge,d.curry=De,d.debounce=Fe,d.defaults=ai,d.defer=Ae,d.delay=Ne,d.difference=fe,d.filter=Xt,d.flatten=ve,d.forEach=Zt,d.forEachRight=Kt,d.forIn=si,d.forInRight=yt,d.forOwn=ui,d.forOwnRight=bt,d.functions=Et,d.groupBy=hi,d.indexBy=fi,d.initial=ye,d.intersection=be,d.invert=_t,d.invoke=Qt,d.keys=ti,d.map=Jt,d.mapValues=Bt,d.max=te,d.memoize=Ie,d.merge=Dt,d.min=ee,d.omit=Ft,d.once=Ye,d.pairs=At,d.partial=qe,d.partialRight=Ue,d.pick=Nt,d.pluck=pi,d.property=en,d.pull=_e,d.range=Re,d.reject=re,d.remove=Te,d.rest=ke,d.shuffle=ae,d.sortBy=le,d.tap=cn,d.throttle=We,d.times=an,d.toArray=ce,d.transform=It,d.union=He,d.uniq=Me,d.values=Yt,d.where=di,d.without=Ce,d.wrap=Xe,d.xor=je,d.zip=Oe,d.zipObject=Pe,d.collect=Jt,d.drop=ke,d.each=Zt,d.eachRight=Kt,d.extend=oi,d.methods=Et,d.object=Pe,d.select=Xt,d.tail=ke,d.unique=Me,d.unzip=Oe,Qe(d),d.clone=pt,d.cloneDeep=dt,d.contains=Ut,d.escape=Ze,d.every=Wt,d.find=$t,d.findIndex=pe,d.findKey=vt,d.findLast=Gt,d.findLastIndex=de,d.findLastKey=gt,d.has=wt,d.identity=Ke,d.indexOf=ge,d.isArguments=ft,d.isArray=Qn,d.isBoolean=Rt,d.isDate=Tt,d.isElement=kt,d.isEmpty=xt,d.isEqual=Ht,d.isFinite=Mt,d.isFunction=Ct,d.isNaN=Ot,d.isNull=Pt,d.isNumber=St,d.isObject=jt,d.isPlainObject=li,d.isRegExp=Lt,d.isString=Vt,d.isUndefined=zt,d.lastIndexOf=we,d.mixin=Qe,d.noConflict=Je,d.noop=tn,d.now=mi,d.parseInt=vi,d.random=nn,d.reduce=ne,d.reduceRight=ie,d.result=rn,d.runInContext=f,d.size=se,d.some=ue,d.sortedIndex=xe,d.template=on,d.unescape=sn,d.uniqueId=un,d.all=Wt,d.any=ue,d.detect=$t,d.findWhere=$t,d.foldl=ne,d.foldr=ie,d.include=Ut,d.inject=ne,Qe(function(){var t={};return ui(d,function(e,n){d.prototype[n]||(t[n]=e)}),t}(),!1),d.first=me,d.last=Ee,d.sample=oe,d.take=me,d.head=me,ui(d,function(t,e){var n="sample"!==e;d.prototype[e]||(d.prototype[e]=function(e,i){var r=this.__chain__,o=t(this.__wrapped__,e,i);return r||null!=e&&(!i||n&&"function"==typeof e)?new m(o,r):o})}),d.VERSION="2.4.2",d.prototype.chain=hn,d.prototype.toString=fn,d.prototype.value=pn,d.prototype.valueOf=pn,Zt(["join","pop","shift"],function(t){var e=Tn[t];d.prototype[t]=function(){var t=this.__chain__,n=e.apply(this.__wrapped__,arguments);return t?new m(n,t):n}}),Zt(["push","reverse","sort","unshift"],function(t){var e=Tn[t];d.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Zt(["concat","slice","splice"],function(t){var e=Tn[t];d.prototype[t]=function(){return new m(e.apply(this.__wrapped__,arguments),this.__chain__)}}),d}var p,d=[],m=[],v=0,g=+new Date+"",y=75,b=40,E=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",w=/\b__p \+= '';/g,_=/\b(__p \+=) '' \+/g,R=/(__e\(.*?\)|\b__t\)) \+\n'';/g,T=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,k=/\w*$/,x=/^\s*function[ \n\r\t]+\w/,H=/<%=([\s\S]+?)%>/g,M=RegExp("^["+E+"]*0+(?=.$)"),C=/($^)/,j=/\bthis\b/,O=/['\n\r\t\u2028\u2029\\]/g,P=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],S=0,L="[object Arguments]",V="[object Array]",z="[object Boolean]",B="[object Date]",D="[object Function]",F="[object Number]",A="[object Object]",N="[object RegExp]",I="[object String]",Y={};Y[D]=!1,Y[L]=Y[V]=Y[z]=Y[B]=Y[F]=Y[A]=Y[N]=Y[I]=!0;var q={leading:!1,maxWait:0,trailing:!1},U={configurable:!1,enumerable:!1,value:null,writable:!1},W={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},X={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},$=W[typeof window]&&window||this,G=W[typeof exports]&&exports&&!exports.nodeType&&exports,Z=W[typeof module]&&module&&!module.nodeType&&module,K=Z&&Z.exports===G&&G,Q=W[typeof global]&&global;!Q||Q.global!==Q&&Q.window!==Q||($=Q);var J=f();"function"==typeof define&&"object"==typeof define.amd&&define.amd?($._=J,define(function(){return J})):G&&Z?K?(Z.exports=J)._=J:G._=J:$._=J}).call(this),THREE.Binder={bind:function(t,e){return function(n,i){i.__binds||(i.__binds=[]);var r=t;_.isArray(n)&&(r=n[0],n=n[1]);for(var o=/^([^.:]*(?:\.[^.:]+)*)?(?:\:(.*))?$/.exec(n),a=o[1].split(/\./g),s=a.pop(),u=o[2]||s,l=a.shift(),c={"this":i}[l]||e[l]||t[l]||r;c&&(n=a.shift());)c=c[n];if(c&&(c.on||c.addEventListener)){var h=function(e){i[u]&&i[u](e,t)};THREE.Binder._polyfill(c,["addEventListener","on"],function(t){c[t](s,h)});var f={target:c,name:s,callback:h};return i.__binds.push(f),h}throw"Cannot bind '"+n+"' in "+this.__name}},unbind:function(){return function(t){t.__binds&&(t.__binds.forEach(function(t){THREE.Binder._polyfill(t.target,["removeEventListener","off"],function(e){t.target[e](t.name,t.callback)})}.bind(this)),t.__binds=[])}},apply:function(t){Object.assign(t,THREE.EventDispatcher.prototype),t.trigger=THREE.Binder._trigger,t.triggerOnce=THREE.Binder._triggerOnce,t.on=t.addEventListener,t.off=t.removeEventListener,t.dispatchEvent=t.trigger},_triggerOnce:function(t){this.trigger(t),this._listeners&&delete this._listeners[t.type]},_trigger:function(t){if(void 0!==this._listeners){var e=t.type,n=this._listeners[e];if(void 0!==n){n=n.slice();var i=n.length;t.target=this;for(var r=0;i>r;r++)n[r].call(this,t,this)}}},_polyfill:function(t,e,n){e.map(function(e){return t.method}),e.length&&n(e[0])}},THREE.Api={apply:function(t){t.set=function(t){var e=this.options||{},n=_.reduce(t,function(t,n,i){return e[i]!==n&&(t[i]=n),t},{});this.options=_.extend(e,n),this.trigger({type:"change",options:t,changes:n})},t.get=function(){return this.options},t.api=function(t,e){return t=t||{},e&&_.each(t,function(t,n,i){_.isFunction(t)&&(i[n]=_.partialRight(t,e))}),t.set=this.set.bind(this),t.get=this.get.bind(this),t}}},THREE.Bootstrap=function(t){if(t){var e=[].slice.apply(arguments);t={},e[0]instanceof Node&&(node=e[0],e=e.slice(1),t.element=node),_.isString(e[0])&&(t.plugins=e),_.isArray(e[0])&&(t.plugins=e[0]),e[0]&&(t=_.defaults(t,e[0]))}if(!(this instanceof THREE.Bootstrap))return new THREE.Bootstrap(t);var n={init:!0,element:document.body,plugins:["core"],aliases:{},plugindb:THREE.Bootstrap.Plugins||{},aliasdb:THREE.Bootstrap.Aliases||{}};this.__options=_.defaults(t||{},n),this.__inited=!1,this.__destroyed=!1,this.__installed=[];var i=this.__options.element;i===""+i&&(i=document.querySelector(i)),this.plugins={},this.element=i,this.__options.init&&this.init()},THREE.Bootstrap.prototype={init:function(){return this.__inited?void 0:(this.__inited=!0,this.install(this.__options.plugins),this)},destroy:function(){return this.__inited&&!this.__destroyed?(this.__destroyed=!0,this.trigger({type:"destroy"}),this.uninstall(),this):void 0},resolve:function(t){function e(t,n,o){if(o>=256)throw"Plug-in alias recursion detected.";return t=_.filter(t,r),_.each(t,function(t){var r=i[t];r?n=n.concat(e(r,[],o+1)):n.push(t)}),n}t=_.isArray(t)?t:[t];var n=this.__options,i=_.extend({},n.aliasdb,n.aliases),r=function(t){var e=t.split(":");return e[1]?(i[e[0]]=[e[1]],!1):!0};return t=_.filter(t,r),_.each(i,function(t,e){i[e]=_.isArray(t)?t:[t]}),e(t,[],0)},install:function(t){t=_.isArray(t)?t:[t],t=this.resolve(t),_.each(t,this.__install,this),this.__ready()},uninstall:function(t){t&&(t=_.isArray(t)?t:[t],t=this.resolve(t)),_.eachRight(t||this.__installed,this.__uninstall,this)},__install:function(t){var e=this.__options.plugindb[t];if(!e)throw"[three.install] Cannot install. '"+t+"' is not registered.";
if(this.plugins[t])return console.warn("[three.install] "+t+" is already installed.");var n=e,i=new n(this.__options[t]||{},t);return this.plugins[t]=i,flag=i.install(this),this.__installed.push(i),this.trigger({type:"install",plugin:i}),flag},__uninstall:function(t,e){return plugin=_.isString(t)?this.plugins[t]:t,plugin?(t=plugin.__name,plugin.uninstall(this),this.__installed=_.without(this.__installed,plugin),delete this.plugins[t],void this.trigger({type:"uninstall",plugin:plugin})):console.warn("[three.uninstall] "+t+"' is not installed.")},__ready:function(){this.triggerOnce({type:"ready"})}},THREE.Binder.apply(THREE.Bootstrap.prototype),THREE.Bootstrap.Plugins={},THREE.Bootstrap.Aliases={},THREE.Bootstrap.Plugin=function(t){this.options=_.defaults(t||{},this.defaults)},THREE.Bootstrap.Plugin.prototype={listen:[],defaults:{},install:function(t){},uninstall:function(t){}},THREE.Binder.apply(THREE.Bootstrap.Plugin.prototype),THREE.Api.apply(THREE.Bootstrap.Plugin.prototype),THREE.Bootstrap.registerPlugin=function(t,e){var n=function(e){THREE.Bootstrap.Plugin.call(this,e),this.__name=t};n.prototype=_.extend(new THREE.Bootstrap.Plugin,e),THREE.Bootstrap.Plugins[t]=n},THREE.Bootstrap.unregisterPlugin=function(t){delete THREE.Bootstrap.Plugins[t]},THREE.Bootstrap.registerAlias=function(t,e){THREE.Bootstrap.Aliases[t]=e},THREE.Bootstrap.unregisterAlias=function(t){delete THREE.Bootstrap.Aliases[t]},THREE.Bootstrap.registerAlias("empty",["fallback","bind","renderer","size","fill","loop","time"]),THREE.Bootstrap.registerAlias("core",["empty","scene","camera","render","warmup"]),THREE.Bootstrap.registerAlias("VR",["core","cursor","fullscreen","render:vr"]),THREE.Bootstrap.registerPlugin("fallback",{defaults:{force:!1,fill:!0,begin:'<div class="threestrap-fallback" style="display: table; width: 100%; height: 100%;box-sizing: border-box; border: 1px dashed rgba(0, 0, 0, .25);"><div style="display: table-cell; padding: 10px; vertical-align: middle; text-align: center;">',end:"</div></div>",message:'<big><strong>This example requires WebGL</strong></big><br>Visit <a target="_blank" href="http://get.webgl.org/">get.webgl.org</a> for more info</a>'},install:function(t){var e;try{if(e=document.createElement("canvas"),gl=e.getContext("webgl")||e.getContext("experimental-webgl"),!gl||this.options.force)throw"WebGL unavailable.";t.fallback=!1}catch(n){var i=this.options.message,r=this.options.begin,o=this.options.end,a=this.options.fill,s=document.createElement("div");for(s.innerHTML=r+i+o,this.children=[];s.childNodes.length>0;)this.children.push(s.firstChild),t.element.appendChild(s.firstChild);return a&&t.install("fill"),this.div=s,t.fallback=!0,!1}},uninstall:function(t){this.children&&(this.children.forEach(function(t){t.parentNode.removeChild(t)}),this.children=null),delete t.fallback}}),THREE.Bootstrap.registerPlugin("renderer",{defaults:{klass:THREE.WebGLRenderer,parameters:{depth:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!0}},listen:["resize"],install:function(t){var e=t.renderer=new this.options.klass(this.options.parameters);t.canvas=e.domElement,t.element.appendChild(e.domElement)},uninstall:function(t){t.element.removeChild(t.renderer.domElement),delete t.renderer,delete t.canvas},resize:function(t,e){var n=e.renderer,i=n.domElement;i&&"CANVAS"==i.tagName?n.setSize(t.renderWidth,t.renderHeight,!1):(n.setRenderSize&&n.setRenderSize(t.renderWidth,t.renderHeight),n.setSize(t.viewWidth,t.viewHeight,!1))}}),THREE.Bootstrap.registerPlugin("bind",{install:function(t){var e={three:t,window:window};t.bind=THREE.Binder.bind(t,e),t.unbind=THREE.Binder.unbind(t),t.bind("install:bind",this),t.bind("uninstall:unbind",this)},uninstall:function(t){t.unbind(this),delete t.bind,delete t.unbind},bind:function(t,e){var n=t.plugin,i=n.listen;i&&i.forEach(function(t){e.bind(t,n)})},unbind:function(t,e){e.unbind(t.plugin)}}),THREE.Bootstrap.registerPlugin("size",{defaults:{width:null,height:null,aspect:null,scale:1,maxRenderWidth:1/0,maxRenderHeight:1/0,devicePixelRatio:!0},listen:["window.resize:queue","element.resize:queue","this.change:queue","ready:resize","pre:pre"],install:function(t){t.Size=this.api({renderWidth:0,renderHeight:0,viewWidth:0,viewHeight:0}),this.resized=!1},uninstall:function(t){delete t.Size},queue:function(t,e){this.resized=!0},pre:function(t,e){this.resized&&(this.resized=!1,this.resize(t,e))},resize:function(t,e){var n,i,r,o,a,s,u,l,c,h=this.options,f=e.element,p=e.renderer,d=0,m=0;n=r=void 0===h.width||null==h.width?f.offsetWidth||f.innerWidth||0:h.width,i=o=void 0===h.height||null==h.height?f.offsetHeight||f.innerHeight||0:h.height,u=n/i,h.aspect&&(h.aspect>u?(i=Math.round(n/h.aspect),m=Math.floor((o-i)/2)):(n=Math.round(i*h.aspect),d=Math.floor((r-n)/2)),u=n/i),c=1,h.devicePixelRatio&&"undefined"!=typeof window&&(c=window.devicePixelRatio||1),a=Math.round(Math.min(n*c*h.scale,h.maxRenderWidth)),s=Math.round(Math.min(i*c*h.scale,h.maxRenderHeight)),raspect=a/s,raspect>u?a=Math.round(s*u):s=Math.round(a/u),c=s/i,l=p.domElement.style,l.width=n+"px",l.height=i+"px",l.marginLeft=d+"px",l.marginTop=m+"px",_.extend(e.Size,{renderWidth:a,renderHeight:s,viewWidth:n,viewHeight:i,aspect:u,pixelRatio:c}),e.trigger({type:"resize",renderWidth:a,renderHeight:s,viewWidth:n,viewHeight:i,aspect:u,pixelRatio:c})}}),THREE.Bootstrap.registerPlugin("fill",{defaults:{block:!0,body:!0,layout:!0},install:function(t){function e(t){var e=t.style.height;return"auto"==e||""==e}function n(t){return t.style.height="100%",t.style.margin=0,t.style.padding=0,t}if(this.options.body&&t.element==document.body&&(this.applied=[t.element,document.documentElement].filter(e).map(n)),this.options.block&&t.canvas&&(t.canvas.style.display="block",this.block=!0),this.options.layout&&t.element){var i=window.getComputedStyle(t.element);"static"==i.position&&(t.element.style.position="relative",this.layout=!0)}},uninstall:function(t){function e(t){return t.style.height="",t.style.margin="",t.style.padding="",t}this.applied&&(this.applied.map(e),delete this.applied),this.block&&t.canvas&&(t.canvas.style.display="",delete this.block),this.layout&&t.element&&(t.element.style.position="",delete this.layout)},change:function(t){this.uninstall(t),this.install(t)}}),THREE.Bootstrap.registerPlugin("loop",{defaults:{start:!0},listen:["ready"],install:function(t){this.running=!1,t.Loop=this.api({start:this.start.bind(this),stop:this.stop.bind(this),running:!1},t),this.events=["pre","update","render","post"].map(function(t){return{type:t}})},uninstall:function(t){this.stop(t)},ready:function(t,e){this.options.start&&this.start(e)},start:function(t){if(!this.running){t.Loop.running=this.running=!0;var e=t.trigger.bind(t),n=function(){this.running&&requestAnimationFrame(n),this.events.map(e)}.bind(this);requestAnimationFrame(n),t.trigger({type:"start"})}},stop:function(t){this.running&&(t.Loop.running=this.running=!1,t.trigger({type:"stop"}))}}),THREE.Bootstrap.registerPlugin("time",{defaults:{speed:1,warmup:0,timeout:1},listen:["pre:tick","this.change"],now:function(){return+new Date/1e3},install:function(t){t.Time=this.api({now:this.now(),clock:0,step:1/60,frames:0,time:0,delta:1/60,average:0,fps:0}),this.last=0,this.time=0,this.clock=0,this.wait=this.options.warmup,this.clockStart=0,this.timeStart=0},tick:function(t,e){var n=this.options.speed,i=this.options.timeout,r=e.Time,o=r.now=this.now(),a=this.last,s=this.time,u=this.clock;if(a){var l=r.delta=o-a,c=r.average||l;l>i&&(l=0);var h=l*n;s+=l,u+=h,r.frames>0&&(r.average=c+.1*(l-c),r.fps=1/c),r.step=h,r.clock=u-this.clockStart,r.time=s-this.timeStart,r.frames++,this.wait-->0&&(this.clockStart=u,this.timeStart=s,r.clock=0,r.step=1e-100)}this.last=o,this.clock=u,this.time=s},uninstall:function(t){delete t.Time}}),THREE.Bootstrap.registerPlugin("scene",{install:function(t){t.scene=new THREE.Scene},uninstall:function(t){delete t.scene}}),THREE.Bootstrap.registerPlugin("camera",{defaults:{near:.1,far:1e4,type:"perspective",fov:60,aspect:null,left:-1,right:1,bottom:-1,top:1,klass:null,parameters:null},listen:["resize","this.change"],install:function(t){t.Camera=this.api(),t.camera=null,this.aspect=1,this.change({},t)},uninstall:function(t){delete t.Camera,delete t.camera},change:function(t,e){var n=this.options,i=e.camera;if(!e.camera||t.changes.type||t.changes.klass){var r=n.klass||{perspective:THREE.PerspectiveCamera,orthographic:THREE.OrthographicCamera}[n.type]||THREE.Camera;e.camera=n.parameters?new r(n.parameters):new r}_.each(n,function(t,i){e.camera.hasOwnProperty(i)&&(e.camera[i]=n[i])}.bind(this)),this.update(e),i===e.camera||e.trigger({type:"camera",camera:e.camera})},resize:function(t,e){this.aspect=t.viewWidth/Math.max(1,t.viewHeight),this.update(e)},update:function(t){t.camera.aspect=this.options.aspect||this.aspect,t.camera.updateProjectionMatrix()}}),THREE.Bootstrap.registerPlugin("render",{listen:["render"],render:function(t,e){e.scene&&e.camera&&e.renderer.render(e.scene,e.camera)}}),THREE.Bootstrap.registerPlugin("warmup",{defaults:{delay:2},listen:["ready","post"],ready:function(t,e){e.renderer.domElement.style.visibility="hidden",this.frame=0,this.hidden=!0},post:function(t,e){this.hidden&&this.frame>=this.options.delay&&(e.renderer.domElement.style.visibility="visible",this.hidden=!1),this.frame++}}),THREE.Stats=function(){var t=Date.now(),e=t,n=0,i=1/0,r=0,o=0,a=1/0,s=0,u=0,l=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(t){t.preventDefault(),y(++l%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var h=document.createElement("div");h.id="fps",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(h);var f=document.createElement("div");f.id="fpsText",f.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",f.innerHTML="FPS",h.appendChild(f);var p=document.createElement("div");for(p.id="fpsGraph",p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",h.appendChild(p);74>p.children.length;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#113",p.appendChild(d)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(m);var v=document.createElement("div");v.id="msText",v.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",v.innerHTML="MS",m.appendChild(v);var g=document.createElement("div");for(g.id="msGraph",g.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(g);74>g.children.length;)d=document.createElement("span"),d.style.cssText="width:1px;height:30px;float:left;background-color:#131",g.appendChild(d);var y=function(t){switch(l=t){case 0:h.style.display="block",m.style.display="none";break;case 1:h.style.display="none",m.style.display="block"}};return{REVISION:11,domElement:c,setMode:y,begin:function(){t=Date.now()},end:function(){var l=Date.now();n=l-t,i=Math.min(i,n),r=Math.max(r,n),v.textContent=n+" MS ("+i+"-"+r+")";var c=Math.min(30,30-30*(n/200));return g.appendChild(g.firstChild).style.height=c+"px",u++,l>e+1e3&&(o=Math.round(1e3*u/(l-e)),a=Math.min(a,o),s=Math.max(s,o),f.textContent=o+" FPS ("+a+"-"+s+")",c=Math.min(30,30-30*(o/100)),p.appendChild(p.firstChild).style.height=c+"px",e=l,u=0),l},update:function(){t=this.end()}}},THREE.DeviceOrientationControls=function(t){var e=this;this.object=t,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.deviceOrientation={},this.screenOrientation=0;var n=function(t){e.deviceOrientation=t},i=function(){e.screenOrientation=window.orientation||0},r=function(){var t=new THREE.Vector3(0,0,1),e=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,o,a,s,u){e.set(a,o,-s,"YXZ"),r.setFromEuler(e),r.multiply(i),r.multiply(n.setFromAxisAngle(t,-u))}}();this.connect=function(){i(),window.addEventListener("orientationchange",i,!1),window.addEventListener("deviceorientation",n,!1),e.freeze=!1},this.disconnect=function(){e.freeze=!0,window.removeEventListener("orientationchange",i,!1),window.removeEventListener("deviceorientation",n,!1)},this.update=function(){if(!e.freeze){var t=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.alpha):0,n=e.deviceOrientation.beta?THREE.Math.degToRad(e.deviceOrientation.beta):0,i=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.gamma):0,o=e.screenOrientation?THREE.Math.degToRad(e.screenOrientation):0;r(e.object.quaternion,t,n,i,o)}}},THREE.FirstPersonControls=function(t,e){function n(t,e){return function(){e.apply(t,arguments)}}this.object=t,this.target=new THREE.Vector3(0,0,0),this.domElement=void 0!==e?e:document,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.freeze=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(t){if(this.domElement!==document&&this.domElement.focus(),t.preventDefault(),t.stopPropagation(),this.activeLook)switch(t.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(t){if(t.preventDefault(),t.stopPropagation(),this.activeLook)switch(t.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(t){this.domElement===document?(this.mouseX=t.pageX-this.viewHalfX,this.mouseY=t.pageY-this.viewHalfY):(this.mouseX=t.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=t.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(t){switch(t.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}},this.onKeyUp=function(t){switch(t.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(t){if(!this.freeze){if(this.heightSpeed){var e=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),n=e-this.heightMin;this.autoSpeedFactor=t*(n*this.heightCoef)}else this.autoSpeedFactor=0;var i=t*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(i+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(i),this.moveLeft&&this.object.translateX(-i),this.moveRight&&this.object.translateX(i),this.moveUp&&this.object.translateY(i),this.moveDown&&this.object.translateY(-i);var r=t*this.lookSpeed;this.activeLook||(r=0);var o=1;this.constrainVertical&&(o=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*r,this.lookVertical&&(this.lat-=this.mouseY*r*o),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=THREE.Math.degToRad(90-this.lat),this.theta=THREE.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var a=this.target,s=this.object.position;a.x=s.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=s.y+100*Math.cos(this.phi),a.z=s.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a)}},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousemove",n(this,this.onMouseMove),!1),this.domElement.addEventListener("mousedown",n(this,this.onMouseDown),!1),this.domElement.addEventListener("mouseup",n(this,this.onMouseUp),!1),this.domElement.addEventListener("keydown",n(this,this.onKeyDown),!1),this.domElement.addEventListener("keyup",n(this,this.onKeyUp),!1),this.handleResize()},THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*f.autoRotateSpeed}function i(){return Math.pow(.95,f.zoomSpeed)}function r(t){if(f.enabled!==!1){if(t.preventDefault(),0===t.button){if(f.noRotate===!0)return;O=j.ROTATE,d.set(t.clientX,t.clientY)}else if(1===t.button){if(f.noZoom===!0)return;O=j.DOLLY,_.set(t.clientX,t.clientY)}else if(2===t.button){if(f.noPan===!0)return;O=j.PAN,g.set(t.clientX,t.clientY)}document.documentElement.addEventListener("mousemove",o,!1),document.documentElement.addEventListener("mouseup",a,!1),f.dispatchEvent(V)}}function o(t){if(f.enabled!==!1){t.preventDefault();var e=f.domElement===document?f.domElement.body:f.domElement;if(O===j.ROTATE){if(f.noRotate===!0)return;m.set(t.clientX,t.clientY),v.subVectors(m,d),f.rotateLeft(2*Math.PI*v.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*v.y/e.clientHeight*f.rotateSpeed),d.copy(m)}else if(O===j.DOLLY){if(f.noZoom===!0)return;R.set(t.clientX,t.clientY),T.subVectors(R,_),T.y>0?f.dollyIn():f.dollyOut(),_.copy(R)}else if(O===j.PAN){if(f.noPan===!0)return;y.set(t.clientX,t.clientY),b.subVectors(y,g),f.pan(b.x,b.y),g.copy(y)}f.update()}}function a(){f.enabled!==!1&&(document.documentElement.removeEventListener("mousemove",o,!1),document.documentElement.removeEventListener("mouseup",a,!1),f.dispatchEvent(z),O=j.NONE)}function s(t){if(f.enabled!==!1&&f.noZoom!==!0){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?f.dollyOut():f.dollyIn(),f.update(),f.dispatchEvent(V),f.dispatchEvent(z)}}function u(t){if(f.enabled!==!1&&f.noKeys!==!0&&f.noPan!==!0)switch(t.keyCode){case f.keys.UP:f.pan(0,f.keyPanSpeed),f.update();break;case f.keys.BOTTOM:f.pan(0,-f.keyPanSpeed),f.update();break;case f.keys.LEFT:f.pan(f.keyPanSpeed,0),f.update();break;case f.keys.RIGHT:f.pan(-f.keyPanSpeed,0),f.update()}}function l(t){if(f.enabled!==!1){switch(t.touches.length){case 1:if(f.noRotate===!0)return;O=j.TOUCH_ROTATE,d.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(f.noZoom===!0)return;O=j.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);_.set(0,i);break;case 3:if(f.noPan===!0)return;O=j.TOUCH_PAN,g.set(t.touches[0].pageX,t.touches[0].pageY);break;default:O=j.NONE}f.dispatchEvent(V)}}function c(t){if(f.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=f.domElement===document?f.domElement.body:f.domElement;switch(t.touches.length){case 1:if(f.noRotate===!0)return;if(O!==j.TOUCH_ROTATE)return;m.set(t.touches[0].pageX,t.touches[0].pageY),v.subVectors(m,d),f.rotateLeft(2*Math.PI*v.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*v.y/e.clientHeight*f.rotateSpeed),d.copy(m),f.update();break;case 2:if(f.noZoom===!0)return;if(O!==j.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(n*n+i*i);R.set(0,r),T.subVectors(R,_),T.y>0?f.dollyOut():f.dollyIn(),_.copy(R),f.update();break;case 3:if(f.noPan===!0)return;if(O!==j.TOUCH_PAN)return;y.set(t.touches[0].pageX,t.touches[0].pageY),b.subVectors(y,g),f.pan(b.x,b.y),g.copy(y),f.update();break;default:O=j.NONE}}}function h(){f.enabled!==!1&&(f.dispatchEvent(z),O=j.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var f=this,p=1e-6,d=new THREE.Vector2,m=new THREE.Vector2,v=new THREE.Vector2,g=new THREE.Vector2,y=new THREE.Vector2,b=new THREE.Vector2,E=new THREE.Vector3,w=new THREE.Vector3,_=new THREE.Vector2,R=new THREE.Vector2,T=new THREE.Vector2,k=0,x=0,H=1,M=new THREE.Vector3,C=new THREE.Vector3,j={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},O=j.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var P=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),S=P.clone().inverse(),L={type:"change"},V={type:"start"},z={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),x-=t},this.rotateUp=function(t){void 0===t&&(t=n()),k-=t},this.panLeft=function(t){var e=this.object.matrix.elements;E.set(e[0],e[1],e[2]),E.multiplyScalar(-t),M.add(E)},this.panUp=function(t){var e=this.object.matrix.elements;E.set(e[4],e[5],e[6]),E.multiplyScalar(t),M.add(E)},this.pan=function(t,e){var n=f.domElement===document?f.domElement.body:f.domElement;if(void 0!==f.object.fov){var i=f.object.position,r=i.clone().sub(f.target),o=r.length();o*=Math.tan(f.object.fov/2*Math.PI/180),f.panLeft(2*t*o/n.clientHeight),f.panUp(2*e*o/n.clientHeight)}else void 0!==f.object.top?(f.panLeft(t*(f.object.right-f.object.left)/n.clientWidth),f.panUp(e*(f.object.top-f.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=i()),H/=t},this.dollyOut=function(t){void 0===t&&(t=i()),H*=t},this.update=function(){var t=this.object.position;w.copy(t).sub(this.target),w.applyQuaternion(P);var e=Math.atan2(w.x,w.z),i=Math.atan2(Math.sqrt(w.x*w.x+w.z*w.z),w.y);this.autoRotate&&this.rotateLeft(n()),e+=x,i+=k,i=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i)),i=Math.max(p,Math.min(Math.PI-p,i));var r=w.length()*H;r=Math.max(this.minDistance,Math.min(this.maxDistance,r)),this.target.add(M),w.x=r*Math.sin(i)*Math.sin(e),w.y=r*Math.cos(i),w.z=r*Math.sin(i)*Math.cos(e),w.applyQuaternion(S),t.copy(this.target).add(w),this.object.lookAt(this.target),x=0,k=0,H=1,M.set(0,0,0),C.distanceToSquared(this.object.position)>p&&(this.dispatchEvent(L),C.copy(this.object.position))},this.reset=function(){O=j.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",h,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",u,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.VRControls=function(t,e){var n=1e-5,i=this.dummy=new THREE.Object3D;this.object=t,this.device=new THREE.DeviceOrientationControls(i,e),this.orbit=new THREE.OrbitControls(i,e),this.orbit.target.copy(t.position),this.orbit.target.z+=n,this.orbit.rotateSpeed=-.25,this.supported=!1;var r=function(t){this.supported=t&&t.alpha==+t.alpha,window.removeEventListener("deviceorientation",r,!1)}.bind(this);window.addEventListener("deviceorientation",r,!1)},THREE.VRControls.prototype.vr=function(t){this.vrstate=t},THREE.VRControls.prototype.update=function(t){var e=!1;this.vrstate&&this.vrstate.orientation?(e=!0,this.object.quaternion.copy(this.vrstate.orientation),this.object.position.copy(this.vrstate.position),this.device.object=this.dummy,this.orbit.object=this.dummy):this.vrstate&&this.supported?(this.device.freeze&&this.device.connect(),this.device.object=this.object,this.orbit.object=this.dummy,this.device.update(t)):(e=!0,this.device.object=this.dummy,this.orbit.object=this.object,this.orbit.update(t)),e&&!this.device.freeze&&this.device.disconnect()},THREE.Bootstrap.registerPlugin("stats",{listen:["pre","post"],install:function(t){var e=this.stats=new THREE.Stats,n=e.domElement.style;n.position="absolute",n.top=n.left=0,t.element.appendChild(e.domElement),t.stats=e},uninstall:function(t){document.body.removeChild(this.stats.domElement),delete t.stats},pre:function(t,e){this.stats.begin()},post:function(t,e){this.stats.end()}}),THREE.Bootstrap.registerPlugin("controls",{listen:["update","resize","camera","this.change"],defaults:{klass:null,parameters:{}},install:function(t){if(!this.options.klass)throw"Must provide class for `controls.klass`";t.controls=null,this._camera=t.camera||new THREE.PerspectiveCamera,this.change(null,t)},uninstall:function(t){delete t.controls},change:function(t,e){this.options.klass?((!t||t.changes.klass)&&(e.controls=new this.options.klass(this._camera,e.renderer.domElement)),_.extend(e.controls,this.options.parameters)):e.controls=null},update:function(t,e){var n=e.Time&&e.Time.delta||1/60,i=e.VR&&e.VR.state;e.controls.vr&&e.controls.vr(i),e.controls.update(n)},camera:function(t,e){e.controls.object=this._camera=t.camera},resize:function(t,e){e.controls.handleResize&&e.controls.handleResize()}}),THREE.Bootstrap.registerPlugin("cursor",{listen:["update","this.change","install:change","uninstall:change","element.mousemove","vr"],defaults:{cursor:null,hide:!1,timeout:3},install:function(t){this.timeout=this.options.timeout,this.element=t.element,this.change(null,t)},uninstall:function(t){delete t.controls},change:function(t,e){this.applyCursor(e)},mousemove:function(t,e){this.options.hide&&(this.applyCursor(e),this.timeout=+this.options.timeout||0)},update:function(t,e){var n=e.Time&&e.Time.delta||1/60;this.options.hide&&(this.timeout-=n,this.timeout<0&&this.applyCursor(e,"none"))},vr:function(t,e){this.hide=t.active&&!t.hmd.fake,this.applyCursor(e)},applyCursor:function(t,e){var n=t.controls?"move":"";e=e||this.options.cursor||n,this.hide&&(e="none"),this.cursor!=e&&(this.element.style.cursor=e)}}),THREE.Bootstrap.registerPlugin("fullscreen",{defaults:{key:"f"},listen:["ready","update"],install:function(t){t.Fullscreen=this.api({active:!1,toggle:this.toggle.bind(this)},t)},uninstall:function(t){delete t.Fullscreen},ready:function(t,e){document.body.addEventListener("keypress",function(t){this.options.key&&t.charCode==this.options.key.charCodeAt(0)&&this.toggle(e)}.bind(this));var n=function(){var t=!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);e.Fullscreen.active=this.active=t,e.trigger({type:"fullscreen",active:t})}.bind(this);document.addEventListener("fullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1)},toggle:function(t){var e=t.canvas,n=t.VR&&t.VR.active?{vrDisplay:t.VR.hmd}:{};this.active?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():e.requestFullScreen?e.requestFullScreen(n):e.msRequestFullScreen?e.msRequestFullscreen(n):e.webkitRequestFullscreen?e.webkitRequestFullscreen(n):e.mozRequestFullScreen&&e.mozRequestFullScreen(n)}}),THREE.Bootstrap.registerPlugin("vr",{defaults:{mode:"auto",device:null,fov:80},listen:["window.load","pre","render","resize","this.change"],install:function(t){t.VR=this.api({active:!1,devices:[],hmd:null,sensor:null,renderer:null,state:null},t)},uninstall:function(t){delete t.VR},mocks:function(t,e,n){var i=.03,r=function(t){return{left:{x:-i,y:0,z:0},right:{x:i,y:0,z:0}}[t]},o=function(i){var r=t.camera,o=r&&r.aspect||16/9,a=(e||r&&r.fov||n)/2,s=180*Math.atan(Math.tan(a*Math.PI/180)*o/2)/Math.PI,u=a;return{left:{rightDegrees:s,leftDegrees:s,downDegrees:u,upDegrees:u},right:{rightDegrees:s,leftDegrees:s,downDegrees:u,upDegrees:u}}[i]},a=function(){return{}};return[{fake:!0,force:1,deviceId:"emu",deviceName:"Emulated",getEyeTranslation:r,getRecommendedEyeFieldOfView:o},{force:2,getState:a}]},load:function(t,e){var n=function(t){this.callback(t,e)}.bind(this);navigator.getVRDevices?navigator.getVRDevices().then(n):navigator.mozGetVRDevices?navigator.mozGetVRDevices(n):(console.warn("No native VR support detected."),n(this.mocks(e,this.options.fov,this.defaults.fov),e))},callback:function(t,e){var n,i,r=window.HMDVRDevice||function(){},o=window.PositionSensorVRDevice||function(){};t=e.VR.devices=t||e.VR.devices;for(var a=this.options.device,s=0;s<t.length;++s){var u=t[s];if(1==u.force||u instanceof r){if(a&&a!=u.deviceId)continue;n=u;break}}if(n){for(var s=0;s<t.length;++s){var u=t[s];if(2==u.force||u instanceof o&&u.hardwareUnitId==n.hardwareUnitId){i=u;break}}this.hookup(n,i,e)}},hookup:function(t,e,n){THREE.VRRenderer||console.log("THREE.VRRenderer not found");var i=THREE.VRRenderer||function(){};this.renderer=new i(n.renderer,t),this.hmd=t,this.sensor=e,n.VR.renderer=this.renderer,n.VR.hmd=t,n.VR.sensor=e,console.log("THREE.VRRenderer",t.deviceName)},change:function(t,e){t.changes.device&&this.callback(null,e),this.pre(t,e)},pre:function(t,e){var n=this.active,i=this.active=this.renderer&&"2d"!=this.options.mode;if(e.VR.active=i,i&&this.sensor){var r=this.sensor.getState();e.VR.state=r}else e.VR.state=null;n!=this.active&&e.trigger({type:"vr",active:i,hmd:this.hmd,sensor:this.sensor})},resize:function(t,e){this.active&&this.renderer.initialize()},render:function(t,e){if(e.scene&&e.camera){var n=this.active?this.renderer:e.renderer;if(this.last!=n&&n==e.renderer){var i=n.getPixelRatio(),r=n.domElement.width/i,o=n.domElement.height/i;n.enableScissorTest(!1),n.setViewport(0,0,r,o)}this.last=n,n.render(e.scene,e.camera)}}}),THREE.Bootstrap.registerPlugin("ui",{defaults:{theme:"white",style:".threestrap-ui { position: absolute; bottom: 5px; right: 5px; float: left; }.threestrap-ui button { border: 0; background: none;  vertical-align: middle; font-weight: bold; } .threestrap-ui .glyphicon { top: 2px; font-weight: bold; } @media (max-width: 640px) { .threestrap-ui button { font-size: 120% } }.threestrap-white button { color: #fff; text-shadow: 0 1px 1px rgba(0, 0, 0, 1), 0 1px 3px rgba(0, 0, 0, 1); }.threestrap-black button { color: #000; text-shadow: 0 0px 1px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1) }"},listen:["fullscreen"],markup:function(t,e,n){var i="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css";location.href.match(/^file:\/\//)&&(i="http://"+i);var r=[];return t.Fullscreen&&r.push('<button class="fullscreen" title="Full Screen"><span class="glyphicon glyphicon-fullscreen"></span></button>'),t.VR&&r.push('<button class="vr" title="VR Headset">VR</button>'),'<style type="text/css">@import url("'+i+'"); '+n+'</style><div class="threestrap-ui threestrap-'+e+'">'+r.join("\n")+"</div>"},install:function(t){var e=this.ui=document.createElement("div");e.innerHTML=this.markup(t,this.options.theme,this.options.style),document.body.appendChild(e);var n=this.ui.fullscreen=e.querySelector("button.fullscreen");n&&t.bind([n,"click:goFullscreen"],this);var i=this.ui.vr=e.querySelector("button.vr");i&&(t.VR.set({mode:"2d"}),t.bind([i,"click:goVR"],this))},uninstall:function(t){document.body.removeChild(ui)},fullscreen:function(t,e){this.ui.style.display=t.active?"none":"block",t.active||e.VR.set({mode:"2d"})},goFullscreen:function(t,e){e.Fullscreen&&e.Fullscreen.toggle()},goVR:function(t,e){e.VR&&(e.VR.set({mode:"auto"}),e.Fullscreen.toggle())},uninstall:function(t){document.body.removeChild(this.ui)}});